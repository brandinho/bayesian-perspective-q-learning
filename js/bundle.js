(function(t,e){'object'==typeof exports&&'undefined'!=typeof module?e():'function'==typeof define&&define.amd?define(e):e()})(this,function(){'use strict';function t(t,e){function a(){for(var a,r=[],l=1,i=1,s=0;s<e;s++){r.push([]);for(var n=0;n<t;n++)a=0==s?n==t-1?y:0==n?m:h:s>=x&&s<x+f&&n>=u&&n<u+g?k.reward:m,r[s].push({x:l,y:i,width:d,height:p,reward:a}),l+=d+o;l=1,i+=p+o}return r}function r(t){var e=L.selectAll('.row').data(t).enter().append('g').attr('class','row'),a=e.selectAll('.square').data(function(t){return t}).enter().append('rect').attr('class','square').attr('x',function(t){return t.x}).attr('y',function(t){return t.y}).attr('width',function(t){return t.width}).attr('height',function(t){return t.height}).style('fill',function(t){return w(t.reward)}).style('stroke','none').style('stroke-width',3),r=L.append('rect').attr('x',k.x).attr('y',k.y).attr('width',k.width).attr('height',k.height).style('fill','none').style('stroke','red').style('stroke-width',3).style('stroke-dasharray','4, 4')}function l(a,r,l,i,s){const n=2;for(var c=1,y=1,h=0;h<e;h++){for(var m=0;m<t;m++){if(0==h){if(m==t-1){a.append(function(){return i.documentElement.cloneNode(!0)}).attr('y',y+n).attr('x',c+n).attr('width',0.9*d).attr('height',0.9*d)}else if(0==m){a.append(function(){return r.documentElement.cloneNode(!0)}).attr('y',y+n).attr('x',c+n).attr('width',0.9*d).attr('height',0.9*d)}else{a.append(function(){return s.documentElement.cloneNode(!0)}).attr('y',y+n).attr('x',c+n).attr('width',0.9*d).attr('height',0.9*d)}}else if(h>=x&&h<x+f&&m>=u&&m<u+g){a.append(function(){return l.documentElement.cloneNode(!0)}).attr('y',y+n).attr('x',c+n).attr('width',0.9*d).attr('height',0.9*d)}c+=d+o}c=1,y+=p+o}}function i(t,e,a){var r=d3.select('#gameOutlineLegend').append('svg').attr('width',300);const l='#4C4845',i=20,s=5,n=45,o=5,d=110;r.append(function(){return e.documentElement.cloneNode(!0)}).attr('x',o).attr('y',s).attr('width',i).attr('height',i),r.append(function(){return a.documentElement.cloneNode(!0)}).attr('x',o).attr('y',n).attr('width',i).attr('height',i),r.append(function(){return t.documentElement.cloneNode(!0)}).attr('x',d).attr('y',s).attr('width',i).attr('height',i),r.append('rect').attr('x',d).attr('y',n).attr('width',i).attr('height',i).style('fill','rgb(230,225,224)');const p=30,c=s+11,y=n+11;r.append('text').attr('x',o+p).attr('y',c).text('Goal: r = 50').style('font-size','12px').style('fill',l).attr('alignment-baseline','middle'),r.append('text').attr('x',o+p).attr('y',y).text('Cliff: r = -50').style('font-size','12px').style('fill',l).attr('alignment-baseline','middle'),r.append('text').attr('x',d+p).attr('y',c).text('Danger Zone: r ~ N(-15, 15\xB2)').style('font-size','12px').style('fill',l).attr('alignment-baseline','middle'),r.append('text').attr('x',d+p).attr('y',y).text('Roaming States: r ~ N(-2, 2\xB2)').style('font-size','12px').style('fill',l).attr('alignment-baseline','middle')}const s=parseInt(d3.select('#gameOutline').style('height')),n=parseInt(d3.select('#gameOutline').style('width')),o=2,d=b((n-(t-1)*o)/t),p=d,c=d+o,y=50,h=-y,m=-2,u=1,x=1,g=2,f=3;var v,k={x:u*c,y:x*c,width:(d+o)*g,height:(p+o)*f,reward:-15,click:0},w=d3.scaleLinear().range(['#ff6961','#eee','#66cc66']).domain([h,0,y]),L=d3.select('#gameOutline').append('svg').attr('width',`${n}px`).attr('height',`${s}px`);Promise.all([d3.xml('assets/start.svg'),d3.xml('assets/danger.svg'),d3.xml('assets/goal.svg'),d3.xml('assets/cliff.svg')]).then((t)=>{var e=t[0],s=t[1],n=t[2],o=t[3];v=a(),r(v),l(L,e,s,n,o),i(s,n,o)})}function e(t,e){var a,l,i,r=0;do a=2*Math.random()-1,l=2*Math.random()-1,i=a*a+l*l;while(1<=i);var s=k(-2*w(i)/i),r=a*s;return r*e+t}function a(t,e,a){return f(-v(t-e,2)/(2*v(a,2)))/(a*k(2*g))}function r(t){let e=0,a=0;for(;0==e;)e=t();for(;0==a;)a=t();const r=k(-2*w(e)),l=2*g*a;return[r*Math.cos(l),r*Math.sin(l)]}function l(t,e,a=0){const[l,i]=r(Math.random);if(0===a)return t+e*l;const s=a/k(1+a*a),n=s*l+k(1-s*s)*i,o=0<=l?n:-n;return t+e*o}function i(t,e){function a(t,e){return t+e}function r(){for(var e,r,l,i,s,n=Math.round,o=Number.EPSILON,d='\\color{#696969}{w_',p=[],c=[],h=0;3>h;h++)l=n(1e3*(v(y,h)+o))/1e3,p.push(l),e='\\color{#696969}{\\gamma^'+(h+'=')+(l+'}'),s=document.querySelectorAll('#mixture-label'+(h+1+' d-math')),s[0].innerHTML=e;for(var t=p.reduce(a),h=0;3>h;h++)i=n(1e3*(p[h]/t+o))/10,c.push(i/100),r=d+(h+1+'=')+(i+'\\%}'),s=document.querySelectorAll('#mixture-label'+(h+1+' d-math')),s[1].innerHTML=r;return c}function i(t,e,a,r){for(var i=[],s=0;s<t;s++)i.push(l(e,a,r));return i}function s(t){for(var e,a,r,l=[],s=0;s<t[0].length;s++){e=t[0][s].x0,a=t[0][s].x0,r=0;for(var i=0;i<t.length;i++)r+=t[i][s].length*n[i];l.push({x0:e,x1:a,length:r})}return l}function o(){j.remove(),B=d3.scaleLinear().domain([0,d3.max(A,function(t){return t.length})]).range([p,0]),j=q.append('path').datum(A).attr('d',T).style('stroke',e).style('stroke-width',2).attr('class','line')}var d={top:5,right:5,bottom:5,left:5},p=parseInt(d3.select('.individual-mixture').style('height'))-d.top-d.bottom,c=parseInt(d3.select('.individual-mixture').style('width'))-d.left-d.right,y=+d3.select('#sliderGammaMixture').attr('value'),h=20,m=5e3;document.querySelector('label[for="barGammaMixture"] span').innerHTML=y;var n=r(),u=i(m,-2,1,5),x=i(m,0,1,0),g=i(m,2,1,-5),f=d3.min([d3.min(u),d3.min(x),d3.min(g)]),k=d3.max([d3.max(u),d3.max(x),d3.max(g)]),w=d3.scaleLinear().domain([f,k]).range([0,c]),b=d3.histogram().domain(w.domain()).thresholds(w.ticks(h))(u),L=d3.histogram().domain(w.domain()).thresholds(w.ticks(h))(x),_=d3.histogram().domain(w.domain()).thresholds(w.ticks(h))(g),M=[b,L,_],A=s(M),E=d3.max([d3.max(b,function(t){return t.length}),d3.max(L,function(t){return t.length}),d3.max(_,function(t){return t.length})]),P=d3.scaleLinear().domain([0,E]).range([p,0]),B=d3.scaleLinear().domain([0,d3.max(A,function(t){return t.length})]).range([p,0]),S=d3.select('#mixture-dist1').append('svg').attr('width',c+d.left+d.right).attr('height',p+d.top+d.bottom).append('g').attr('transform','translate('+d.left+','+d.top+')'),D=d3.select('#mixture-dist2').append('svg').attr('width',c+d.left+d.right).attr('height',p+d.top+d.bottom).append('g').attr('transform','translate('+d.left+','+d.top+')'),z=d3.select('#mixture-dist3').append('svg').attr('width',c+d.left+d.right).attr('height',p+d.top+d.bottom).append('g').attr('transform','translate('+d.left+','+d.top+')'),q=d3.select('#mixture').append('svg').attr('width',c+d.left+d.right).attr('height',p+d.top+d.bottom).append('g').attr('transform','translate('+d.left+','+d.top+')'),G=d3.line().x(function(t){return w(t.x0)}).y(function(t){return P(t.length)}).curve(d3.curveBasis),T=d3.line().x(function(t){return w(t.x0)}).y(function(t){return B(t.length)}).curve(d3.curveBasis),Q=S.append('path').datum(b).attr('d',G).style('stroke',t).style('stroke-width',2).attr('class','line'),R=D.append('path').datum(L).attr('d',G).style('stroke',t).style('stroke-width',2).attr('class','line'),H=z.append('path').datum(_).attr('d',G).style('stroke',t).style('stroke-width',2).attr('class','line'),j=q.append('path').datum(A).attr('d',T).style('stroke',e).style('stroke-width',2).attr('class','line');d3.select('#sliderGammaMixture').on('input',function(){y=+this.value,document.querySelector('label[for="barGammaMixture"] span').innerHTML=y,n=r(),A=s(M),o()})}function s(t,e,a,r,l){function s(t,e){for(var a=[],r=0;r<A;r++)for(var l=-(e-1);l<_-(e-1);l++)0==l%e?a.push(t[r*b+l]):a.push(0);return a}function n(t,e,a){return t.reduce((t,a,r)=>t+v(e,r)*a,0)/a}function o(t,e,a){for(var r=[],l=0;r.length<A;)r.push(n(t.slice(l,l+_),e,a)),l+=_;return r}function d(t){for(var e,a=[],r=0;r<=b;r++)e=v(t,r),0==r?a.push({x:r,y:e}):a.push({x:r,y:a[a.length-1].y+e});return a}function p(t){return t.charAt(0).toUpperCase()+t.slice(1)}function c(t,e){for(var a=0;a<t.length;a++)t[a].y=t[a].length/e}function y(t){var e=i[_].y*(1-1/M)/_,a=i[_].y/M;return e*t+a}function u(){for(var t=[],e=0;e<=_;e++)t.push({x:e,y:y(e)});return t}function x(){i=d(w),nt=u(),Q=o(T,w,i[_-1].y),C=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(Q),c(C,Q.length),et.remove(),st.remove(),lt.remove(),ot.remove();for(var t=[],e=0;e<C.length;e++)0<C[e].length&&t.push(C[e].x0);et=1<t.length?F.append('path').datum(C).attr('d',J).style('stroke',r).style('fill',r).style('fill-opacity',0.3).attr('class','line'):F.append('line').attr('x1',H(t[0])).attr('y1',0).attr('x2',H(t[0])).attr('y2',m).attr('marker-start','url(#arrow-means)').style('stroke',r).style('stroke-width',2).style('class','line'),lt=X.append('line').attr('x1',j(_)).attr('y1',0).attr('x2',j(_)).attr('y2',m).style('stroke',l).style('stroke-width',2).style('class','line'),st=X.append('path').datum(i).attr('d',Z).style('stroke',l).attr('class','line'),ot=X.append('path').datum(nt).attr('d',Z).style('stroke-dasharray','5, 5').style('stroke','orange').attr('class','line'),ct.attr('y',U(i[_].y/M)-pt),ct.raise()}var g={top:10,right:10,bottom:50,left:50},m=350-g.top-g.bottom,f=350-g.left-g.right,k=40,w=+d3.select('#sliderGammaQDistribution').attr('value'),L=+d3.select('#sliderGammaQDistribution').attr('max'),_=+d3.select('#sliderSizeQDistribution').attr('value'),b=+d3.select('#sliderSizeQDistribution').attr('max'),M=+d3.select('#sliderSparsityQDistribution').attr('value'),A=500,E=5;document.querySelector('label[for="barGammaQDistribution"] span').innerHTML=w,document.querySelector('label[for="barSizeQDistribution"] span').innerHTML=_,document.querySelector('label[for="barSparsityQDistribution"] span').innerHTML=M-1;var P=d3.selectAll('input[name="distribution-type"]:checked').property('value');const B=d(0),S=d(1),D=[];for(var z=0;z<=b;z++)D.push({x:B[z].x,lower:B[z].y,upper:S[z].y});var i=d(w),q=d(L),G=t[p(P)+' Data'],T=s(G,M),Q=o(T,w,i[_-1].y),R=o(T,L,q[q.length-1].y),H=d3.scaleLinear().domain(d3.extent(T)).range([0,f]),j=d3.scaleLinear().domain([0,i.length]).range([0,f]),I=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(T),C=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(Q),N=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(R);c(I,T.length),c(C,Q.length),c(N,R.length);var V=d3.scaleLinear().domain([0,d3.max(N,function(t){return t.y})]).range([m,0]).nice(),U=d3.scaleLinear().domain([0,b]).range([m,0]),Y=d3.axisBottom(H),K=d3.axisBottom(j),O=d3.axisLeft(V).ticks(7),W=d3.axisLeft(U),F=d3.select('#QDistribution').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${m+g.top+g.bottom} ${f+g.left+g.right}`).classed('svg-content-responsive',!0).append('g').attr('transform','translate('+g.left+','+g.top+')');F.append('defs').append('marker').attr('id','arrow-underlying').attr('viewBox',[0,0,E,E]).attr('refX',E/2).attr('refY',E/2).attr('markerWidth',E).attr('markerHeight',E).attr('orient','auto-start-reverse').append('path').attr('d',d3.line()([[0,0],[0,E],[E,E/2]])).attr('fill',a),F.append('defs').append('marker').attr('id','arrow-means').attr('viewBox',[0,0,E,E]).attr('refX',E/2).attr('refY',E/2).attr('markerWidth',E).attr('markerHeight',E).attr('orient','auto-start-reverse').append('path').attr('d',d3.line()([[0,0],[0,E],[E,E/2]])).attr('fill',r);var X=d3.select('#EffectiveSampleSize').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${m+g.top+g.bottom} ${f+g.left+g.right}`).classed('svg-content-responsive',!0).append('g').attr('transform','translate('+g.left+','+g.top+')'),J=d3.area().x(function(t){return H(t.x0)}).y0(m).y1(function(t){return V(t.y)}).curve(d3.curveBasis),Z=d3.line().x(function(t){return j(t.x)}).y(function(t){return U(t.y)}).curve(d3.curveBasis),$=d3.area().x(function(t){return j(t.x)}).y0(function(t){return U(t.lower)}).y1(function(t){return U(t.upper)}).curve(d3.curveCardinal),tt=F.append('path').datum(I).attr('d',J).style('stroke',a).style('fill',a).style('fill-opacity',0.3).attr('class','line'),et=F.append('path').datum(C).attr('d',J).style('stroke',r).style('fill',r).style('fill-opacity',0.3).attr('class','line'),at=X.append('path').datum(B).attr('d',Z).style('stroke',r).style('stroke-dasharray','3, 3').attr('class','line'),rt=X.append('path').datum(S).attr('d',Z).style('stroke',r).style('stroke-dasharray','3, 3').attr('class','line'),lt=X.append('line').attr('x1',j(_)).attr('y1',0).attr('x2',j(_)).attr('y2',m).style('stroke',l).style('stroke-width',2).style('class','line'),it=X.append('path').datum(D).attr('d',$).style('fill',r).style('opacity',0.1),st=X.append('path').datum(i).attr('d',Z).style('stroke',l).attr('class','line'),nt=u(),ot=X.append('path').datum(nt).attr('d',Z).style('stroke-dasharray','5, 5').style('stroke','orange').attr('class','line');const dt=15,pt=dt/2;var ct=X.append(function(){return e.documentElement.cloneNode(!0)}).attr('y',U(i[_].y/M)-pt).attr('x',j(0)-pt).attr('width',dt).attr('height',dt);ct.select('path').style('fill','orange'),d3.select('#sliderSizeQDistribution').on('input',function(){_=+this.value,document.querySelector('label[for="barSizeQDistribution"] span').innerHTML=_,T=s(G,M),I=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(T),c(I,T.length),tt.remove();for(var t=[],e=0;e<I.length;e++)0<I[e].length&&t.push(I[e].x0);tt=1<t.length?F.append('path').datum(I).attr('d',J).style('stroke',a).style('fill',a).style('fill-opacity',0.3).attr('class','line'):F.append('line').attr('x1',H(t[0])).attr('y1',0).attr('x2',H(t[0])).attr('y2',m).attr('marker-start','url(#arrow-underlying)').style('stroke',a).style('stroke-width',2).style('class','line'),x()}),d3.select('#sliderGammaQDistribution').on('input',function(){w=+this.value,document.querySelector('label[for="barGammaQDistribution"] span').innerHTML=w,x()}),d3.select('#sliderSparsityQDistribution').on('input',function(){M=+this.value,document.querySelector('label[for="barSparsityQDistribution"] span').innerHTML=M-1,T=s(G,M),I=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(T),c(I,T.length),tt.remove();for(var t=[],e=0;e<I.length;e++)0<I[e].length&&t.push(I[e].x0);tt=1<t.length?F.append('path').datum(I).attr('d',J).style('stroke',a).style('fill',a).style('fill-opacity',0.3).attr('class','line'):F.append('line').attr('x1',H(t[0])).attr('y1',0).attr('x2',H(t[0])).attr('y2',m).attr('marker-start','url(#arrow-underlying)').style('stroke',a).style('stroke-width',2).style('class','line'),x()}),d3.selectAll('input[name="distribution-type"]').on('change',function(){if(P=this.value,'skew'==P)var e=0;else if('bernoulli'==P)var e=0.5;G=t[p(P)+' Data'],T=s(G,M),R=o(T,L,q[q.length-1].y),H=d3.scaleLinear().domain([d3.min(G)-e,d3.max(G)+e]).range([0,f]),Y=d3.axisBottom(H),I=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(T),N=d3.histogram().domain(H.domain()).thresholds(H.ticks(k))(R),c(I,T.length),c(N,R.length),V=d3.scaleLinear().domain([0,d3.max(N,function(t){return t.y})]).range([m,0]).nice(),O=d3.axisLeft(V).ticks(7),F.select('.x').transition().duration(2e3).ease(d3.easePoly).call(Y),F.select('.y').transition().duration(2e3).ease(d3.easePoly).call(O),tt.remove();for(var r=[],l=0;l<I.length;l++)0<I[l].length&&r.push(I[l].x0);tt=1<r.length?F.append('path').datum(I).attr('d',J).style('stroke',a).style('fill',a).style('fill-opacity',0.3).attr('class','line'):F.append('line').attr('x1',H(r[0])).attr('y1',0).attr('x2',H(r[0])).attr('y2',m).attr('marker-start','url(#arrow-underlying)').style('stroke',a).style('stroke-width',2).style('class','line'),x()});const yt=parseInt(d3.select('#QDistributionLegend').style('height'));var ht=d3.select('#QDistributionLegend').append('svg').attr('width',450);const mt='#4C4845',ut=15,xt=12,gt=10,ft=155;if(30==yt)var vt=4,kt=vt+9,wt=kt,bt=290;else var vt=34,kt=13,wt=kt+30,bt=2;ht.append('circle').attr('cx',gt).attr('cy',xt).attr('r',6).style('fill',a),ht.append('circle').attr('cx',ft).attr('cy',xt).attr('r',6).style('fill',r);var Lt=ht.append(function(){return e.documentElement.cloneNode(!0)}).attr('x',bt).attr('y',vt).attr('width',ut).attr('height',ut);Lt.select('path').style('fill','orange');const _t=13;ht.append('text').attr('x',gt+_t).attr('y',kt).text('Underlying Reward').style('font-size','12px').style('fill',mt).attr('alignment-baseline','middle'),ht.append('text').attr('x',ft+_t).attr('y',kt).text('Q-Value Distribution').style('font-size','12px').style('fill',mt).attr('alignment-baseline','middle'),ht.append('text').attr('x',bt+_t+10).attr('y',wt).text('Effective Timesteps').style('font-size','12px').style('fill',mt).attr('alignment-baseline','middle');const Mt=40,At=35;F.append('g').attr('class','x axis').attr('transform','translate(0,'+m+')').call(Y).append('text').attr('class','axis-label').attr('y',Mt).attr('x',f/2).attr('fill','black').text('Q-Value'),X.append('g').attr('class','x axis').attr('transform',`translate(${0},${m})`).call(K).append('text').attr('class','axis-label').attr('y',Mt).attr('x',f/2).attr('fill','black').text('Timesteps'),F.append('g').attr('class','y axis').call(O).append('text').attr('class','axis-label').attr('y',-At).attr('x',-m/2).attr('fill','black').attr('transform',`rotate(-90)`).attr('text-anchor','middle').text('Density'),X.append('g').attr('class','y axis').call(W).append('text').attr('class','axis-label').attr('y',-At).attr('x',-m/2).attr('fill','black').attr('transform',`rotate(-90)`).attr('text-anchor','middle').text('Effective Timesteps'),ct.raise()}function n(t,e,r){function l(t,e){for(var r=[],l=t-4*e;l<t+4*e;l+=(t+4*e-(t-4*e))/200)r.push({x:l,y:a(l,t,e)});return r}function i(t,e,a,r){return e/(e+r)*a+r/(e+r)*t}function s(t,e){return t*e/(t+e)}function n(){d3.select('.bayesian-prior').remove(),d3.select('.bayesian-likelihood').remove(),d3.select('.constant-prior').remove(),d3.select('.constant-likelihood').remove(),d3.select('.bayesian-posterior').remove(),d3.select('.constant-posterior').remove(),w=v/(1/g-1),b=k,L=k,_=w,M=w,S=l(b,_),D=l(f,v),z=l(L,M),q=l(f,v),N=d3.extent(S,R),V=d3.extent(z,R),O=d3.scaleLinear().domain([d3.min([N[0],U[0]]),d3.max([N[1],U[1]])]).range([x,0]).nice(),W=d3.scaleLinear().domain([d3.min([V[0],Y[0]]),d3.max([V[1],Y[1]])]).range([x,0]).nice(),Z=d3.axisLeft(O).ticks(6).tickSize(0).tickPadding(10),$=d3.axisLeft(W).ticks(6).tickSize(0).tickPadding(10),F.select('.axis').transition().duration(A).ease(d3.easePoly).call(Z),X.select('.axis').transition().duration(A).ease(d3.easePoly).call($),at(S,t,'bayesian-prior',F),at(D,e,'bayesian-likelihood',F),at(z,t,'constant-prior',X),at(q,e,'constant-likelihood',X),E=0}var o,d,p,c,y={top:50,right:10,bottom:50,left:50},h=350,m=350,u=h-y.left-y.right,x=m-y.top-y.bottom,g=+d3.select('#sliderAlpha').attr('value'),f=1,v=3,k=4.5,w=v/(1/g-1),b=k,L=k,_=w,M=w,A=2e3,E=0;document.querySelector('label[for="barAlpha"] span').innerHTML=g;var P,B,S=l(b,_),D=l(f,v),z=l(L,M),q=l(f,v),G=d3.select('#bayesian-alpha-plot').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${m} ${h}`).classed('svg-content-responsive',!0),T=d3.select('#constant-alpha-plot').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${m} ${h}`).classed('svg-content-responsive',!0);const Q=(t)=>t.x,R=(t)=>t.y;var H=d3.extent(S,Q),j=d3.extent(z,Q),I=d3.extent(D,Q),C=d3.extent(q,Q),N=d3.extent(S,R),V=d3.extent(z,R),U=d3.extent(D,R),Y=d3.extent(q,R);const K=d3.scaleLinear().domain([d3.min([H[0],j[0],I[0],C[0]]),d3.max([H[1],j[1],I[1],C[1]])]).range([0,u]).nice();var O=d3.scaleLinear().domain([d3.min([N[0],U[0]]),d3.max([N[1],U[1]])]).range([x,0]).nice(),W=d3.scaleLinear().domain([d3.min([V[0],Y[0]]),d3.max([V[1],Y[1]])]).range([x,0]).nice();const F=G.append('g').attr('transform',`translate(${y.left},${y.top})`),X=T.append('g').attr('transform',`translate(${y.left},${y.top})`),J=d3.axisBottom(K).ticks(6).tickSize(0).tickPadding(20);var Z=d3.axisLeft(O).ticks(6).tickSize(0).tickPadding(10),$=d3.axisLeft(W).ticks(6).tickSize(0).tickPadding(10);F.append('g').attr('class','axis').call(Z),X.append('g').attr('class','axis').call($),F.append('g').call(J).attr('transform',`translate(0,${x})`),X.append('g').call(J).attr('transform',`translate(0,${x})`),F.append('text').attr('x',u/2).attr('y',0-y.top/2).attr('text-anchor','middle').style('font-size','16px').style('fill','#696969').text('Regular Bayesian Update'),X.append('text').attr('x',u/2).attr('y',0-y.top/2).attr('text-anchor','middle').style('font-size','16px').style('fill','#696969').text('Constant Alpha Update');const tt=d3.line().x((t)=>K(Q(t))).y((t)=>O(R(t))).curve(d3.curveBasis),et=d3.line().x((t)=>K(Q(t))).y((t)=>W(R(t))).curve(d3.curveBasis),at=(e,t,a,r)=>{function l(){var r=d3.scaleQuantile().domain([0,1]).range(d3.range(1,e.length+1));return function(l){if(a.includes('bayesian'))return tt(e.slice(0,r(l)));return a.includes('constant')?et(e.slice(0,r(l))):void 0}}const i=r.append('path').attr('stroke',t).attr('stroke-width',3).attr('fill','none').attr('class',a);a.includes('bayesian')?i.attr('d',tt(e)).transition().duration(A).attrTween('d',l):a.includes('constant')&&i.attr('d',et(e)).transition().duration(A).attrTween('d',l)};n(),Promise.all([d3.xml('assets/next.svg'),d3.xml('assets/refresh.svg')]).then((a)=>{var y=60,h=30,m=10,u=d3.select('#next-button').append('svg').attr('width',y).attr('height',y+h);u.append(function(){return a[0].documentElement.cloneNode(!0)}).attr('width',y).attr('y',-m).attr('class','probability-buttons').on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mousedown',function(){u.selectAll('path').style('fill-opacity',0.7)}).on('mouseup',function(){u.selectAll('path').style('fill-opacity',1)}).on('click',function(){if(0!=E){d3.select('.bayesian-prior').remove();var e=d3.select('.bayesian-posterior').transition();b=o,_=p,S=l(b,_),e.duration(1e3).attr('stroke',t).attr('class','bayesian-prior'),d3.select('.constant-prior').remove();var a=d3.select('.constant-posterior').transition();L=d,M=c+M*g,z=l(L,M),a.duration(1e3).attr('stroke',t).attr('class','constant-prior').attr('d',et(z))}o=i(b,_,f,v),p=s(_,v),d=i(L,M,f,v),c=s(M,v),P=l(o,p),B=l(d,c);var n=d3.extent(P,R),y=d3.extent(B,R);O=d3.scaleLinear().domain([d3.min([N[0],U[0]]),n[1]]).range([x,0]).nice(),W=d3.scaleLinear().domain([d3.min([V[0],Y[0]]),y[1]]).range([x,0]).nice(),Z=d3.axisLeft(O).ticks(6).tickSize(0).tickPadding(10),$=d3.axisLeft(W).ticks(6).tickSize(0).tickPadding(10),F.select('.axis').transition().duration(A).ease(d3.easePoly).call(Z),X.select('.axis').transition().duration(A).ease(d3.easePoly).call($),0==E?(d3.select('.bayesian-prior').transition().duration(A).attr('d',tt(S)),d3.select('.constant-prior').transition().duration(A).attr('d',et(z))):(e.duration(A).attr('d',tt(S)),a.duration(A).attr('d',et(z))),d3.select('.bayesian-likelihood').transition().duration(A).attr('d',tt(D)),d3.select('.constant-likelihood').transition().duration(A).attr('d',et(q)),at(P,r,'bayesian-posterior',F),at(B,r,'constant-posterior',X),E++});var k=d3.select('#refresh-button').append('svg').attr('width',y).attr('height',y+h);k.append(function(){return a[1].documentElement.cloneNode(!0)}).attr('width',y).attr('y',-m).attr('class','probability-buttons').on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mousedown',function(){k.selectAll('path').style('fill-opacity',0.7)}).on('mouseup',function(){k.selectAll('path').style('fill-opacity',1)}).on('click',function(){n()});const w='#56ddd2';u.select('path:nth-child(1)').style('fill',w),u.select('path:nth-child(2)').style('fill',w),k.selectAll('path:nth-child(1)').style('fill',w),k.selectAll('path:nth-child(2)').style('fill',w);const G='bold 10pt arial';u.append('text').text('Posterior').attr('x',y/2).attr('y',y+h-m).style('font',G).attr('alignment-baseline','middle').style('text-anchor','middle'),k.append('text').text('Refresh').attr('x',y/2).attr('y',y+h-m).style('font',G).attr('alignment-baseline','middle').style('text-anchor','middle');const T=20,Q=12,H=20;var j=d3.select('#constantAlphaLegend').append('svg').attr('width',T+280);j.append('circle').attr('cx',T).attr('cy',Q).attr('r',6).style('fill',t),j.append('circle').attr('cx',T+75).attr('cy',Q).attr('r',6).style('fill',e),j.append('circle').attr('cx',T+190).attr('cy',Q).attr('r',6).style('fill',r);const I='#4C4845';j.append('text').attr('x',T+H).attr('y',Q).text('Prior').style('font-size','16px').style('fill',I).attr('alignment-baseline','middle'),j.append('text').attr('x',T+75+H).attr('y',Q).text('Likelihood').style('font-size','16px').style('fill',I).attr('alignment-baseline','middle'),j.append('text').attr('x',T+190+H).attr('y',Q).text('Posterior').style('font-size','16px').style('fill',I).attr('alignment-baseline','middle')}),d3.select('#sliderAlpha').on('change',function(){g=+this.value,document.querySelector('label[for="barAlpha"] span').innerHTML=g,n()})}function o(t,r,l){function i(t,e,a){var r=document.getElementById(t),l=document.createElement('option');l.appendChild(document.createTextNode(e)),l.value=a,r.appendChild(l)}function s(t,e){for(var a=document.getElementById(t),r=0;r<a.length;r++)a.options[r].value==e&&a.remove(r)}function n(e){var a=0<=e?1:-1;e=Math.abs(e);var r=1/(1+0.3275911*e),t=1-((((1.061405429*r+-1.453152027)*r+1.421413741)*r+-0.284496736)*r+0.254829592)*r*f(-e*e);return a*t}function o(t,e,a){return(1+n((t-e)/a/1.4142135623730951))/2}function d(t){var e,a,r,l=-0.00778489400243029,i=-0.322396458041136,s=-2.40075827716184,n=-2.54973253934373,o=4.37466414146497,d=2.93816398269878,p=0.00778469570904146,c=0.32246712907004,y=2.445134137143,h=3.75440866190742,m=0.02425;return 0>t||1<t?(alert('NormSInv: Argument out of range.'),r=0):t<m?(e=k(-2*w(t)),r=(((((l*e+i)*e+s)*e+n)*e+o)*e+d)/((((p*e+c)*e+y)*e+h)*e+1)):t<=1-m?(e=t-0.5,a=e*e,r=(((((-39.6968302866538*a+220.946098424521)*a+-275.928510446969)*a+138.357751867269)*a+-30.6647980661472)*a+2.50662827745924)*e/(((((-54.4760987982241*a+161.585836858041)*a+-155.698979859887)*a+66.8013118877197)*a+-13.2806815528857)*a+1)):(e=k(-2*w(1-t)),r=-(((((l*e+i)*e+s)*e+n)*e+o)*e+d)/((((p*e+c)*e+y)*e+h)*e+1)),r}function p(t){return 1/k(2*g)*f(-v(t,2)/2)}function c(t,e,a,r){var l,i;return null==a?null!=r&&(l=o(r,t,e),i=1):(l=1-o(a,t,e),i=-1),1==l?0:0==l?t:(t+i*e*(p(d(l))/(1-l)))*(1-l)}function y(t,a,r,l){var i;if('epsilon-greedy'==t)i=a;else if('thompson-sampling'==t)i=e(a,r);else if('upper-confidence-bound'==t)i=a+2*r;else if('myopic-vpi'==t){var s,n,d;'One'==l?_>=M?(s=o(M,_,A),n=c(_,A,M,null),d=M*s-n):(s=1-o(M,_,A),n=c(_,A,null,M),d=n-M*s):'Two'==l&&(M>=_?(s=o(_,M,E),n=c(M,E,_,null),d=_*s-n):(s=1-o(_,M,E),n=c(M,E,null,_),d=n-_*s)),i=a+d}return i}function h(t,e){for(var r=[],l=t-4*e;l<t+4*e;l+=(t+4*e-(t-4*e))/200)r.push({x:l,y:a(l,t,e)});return r}function m(e,a){if('epsilon-greedy'==e&&Math.random()<P)var l=10,i=2*(Math.random()*l)-l,s=2*(Math.random()*l)-l;else var i=y(e,_,A,'One'),s=y(e,M,E,'Two');a.append('circle').attr('class','action-circle').attr('cx',K(i)).attr('cy',O(0)).attr('r',5).style('fill',t),a.append('circle').attr('class','action-circle').attr('cx',K(s)).attr('cy',O(0)).attr('r',5).style('fill',r)}function u(){d3.select('.plot1-dist1').remove(),d3.select('.plot1-dist2').remove(),d3.select('.plot2-dist1').remove(),d3.select('.plot2-dist2').remove(),d3.selectAll('.action-circle').remove(),G=h(_,A),T=h(M,E),$(G,t,'plot1-dist1',W),$(T,r,'plot1-dist2',W),$(G,t,'plot2-dist1',F),$(T,r,'plot2-dist2',F),m(z,W),m(q,F)}var x={top:50,right:10,bottom:50,left:50},b=350,L=350,_=+d3.select('#sliderExplorationPolicyMu1').attr('value'),M=+d3.select('#sliderExplorationPolicyMu2').attr('value'),A=+d3.select('#sliderExplorationPolicySigma1').attr('value'),E=+d3.select('#sliderExplorationPolicySigma2').attr('value'),P=0.1,B={"epsilon-greedy":'Epsilon-Greedy',"upper-confidence-bound":'Bayes-UCB',"thompson-sampling":'Q-Value Sampling',"myopic-vpi":'Myopic-VPI'},S=document.getElementById('exploration-policy-one-dropdown'),D=document.getElementById('exploration-policy-two-dropdown'),z=S.options[S.selectedIndex].value,q=D.options[D.selectedIndex].value;document.querySelector('label[for="barExplorationPolicyMu1"] span').innerHTML=_,document.querySelector('label[for="barExplorationPolicyMu2"] span').innerHTML=M,document.querySelector('label[for="barExplorationPolicySigma1"] span').innerHTML=A,document.querySelector('label[for="barExplorationPolicySigma2"] span').innerHTML=E;var G=h(_,A),T=h(M,E),Q=d3.select('#exploration-policy-one-plot').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${L} ${b}`).classed('svg-content-responsive',!0),R=d3.select('#exploration-policy-two-plot').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${L} ${b}`).classed('svg-content-responsive',!0);const H=(t)=>t.x,j=(t)=>t.y,I=b-x.left-x.right,C=L-x.top-x.bottom;var N=d3.extent(G,H),V=d3.extent(T,H),U=d3.extent(G,j),Y=d3.extent(T,j),K=d3.scaleLinear().domain([-25,25]).range([0,I]).nice(),O=d3.scaleLinear().domain([0,0.4]).range([C,0]).nice();const W=Q.append('g').attr('transform',`translate(${x.left},${x.top})`),F=R.append('g').attr('transform',`translate(${x.left},${x.top})`);var X=d3.axisBottom(K).ticks(6).tickSize(0).tickPadding(20),J=d3.axisLeft(O).ticks(6).tickSize(0).tickPadding(10);W.append('g').attr('class','y-axis').call(J),F.append('g').attr('class','y-axis').call(J),W.append('g').call(X).attr('class','x-axis').attr('transform',`translate(0,${C})`),F.append('g').call(X).attr('class','x-axis').attr('transform',`translate(0,${C})`),W.append('text').attr('class','chart-title').attr('x',I/2).attr('y',0-x.top/2).attr('text-anchor','middle').style('font-size','16px').style('fill','#696969').text(B[z]),F.append('text').attr('class','chart-title').attr('x',I/2).attr('y',0-x.top/2).attr('text-anchor','middle').style('font-size','16px').style('fill','#696969').text(B[q]);const Z=d3.line().x((t)=>K(H(t))).y((t)=>O(j(t))).curve(d3.curveBasis),$=(t,e,a,r)=>{r.append('path').attr('stroke',e).attr('stroke-width',3).attr('fill','none').attr('class',a).attr('d',Z(t))};u(),d3.select('#sliderExplorationPolicyMu1').on('input',function(){_=+this.value,document.querySelector('label[for="barExplorationPolicyMu1"] span').innerHTML=_,u()}),d3.select('#sliderExplorationPolicyMu2').on('input',function(){M=+this.value,document.querySelector('label[for="barExplorationPolicyMu2"] span').innerHTML=M,u()}),d3.select('#sliderExplorationPolicySigma1').on('input',function(){A=+this.value,document.querySelector('label[for="barExplorationPolicySigma1"] span').innerHTML=A,u()}),d3.select('#sliderExplorationPolicySigma2').on('input',function(){E=+this.value,document.querySelector('label[for="barExplorationPolicySigma2"] span').innerHTML=E,u()}),d3.select('#exploration-policy-one-dropdown').on('change',function(){i('exploration-policy-two-dropdown',B[z],z),z=this.value,s('exploration-policy-two-dropdown',z),W.select('.chart-title').text(B[z]),u(),'epsilon-greedy'==z||'thompson-sampling'==z||'epsilon-greedy'==q||'thompson-sampling'==q?et.style('display','block'):et.style('display','none')}),d3.select('#exploration-policy-two-dropdown').on('change',function(){i('exploration-policy-one-dropdown',B[q],q),q=this.value,s('exploration-policy-one-dropdown',q),F.select('.chart-title').text(B[q]),u(),'epsilon-greedy'==z||'thompson-sampling'==z||'epsilon-greedy'==q||'thompson-sampling'==q?et.style('display','block'):et.style('display','none')});const tt=80;var et=d3.select('#sampleButton').append('svg').attr('width',`${tt}`).attr('height',`${tt/2}`);(function(){et.append('rect').attr('fill',l).attr('width',`${tt}`).attr('height',`${tt/2}`).attr('rx',10).on('click',function(){u()}),et.append('text').text('Sample').attr('class','button-text').attr('x',`${tt/2}`).attr('y',`${tt/4}`).on('click',function(){u()})})()}function d(t,e,a,r,l,i,s){function n(t){var e=d3.min(t,V),a=d3.min(t,U),r=d3.min(t,Y),l=d3.min(t,K),i=d3.min(t,O),s=d3.max(t,W),n=d3.max(t,F),o=d3.max(t,X),d=d3.max(t,J),p=d3.max(t,Z);E=d3.scaleLinear().domain([d3.min([e,a,r,l,i]),d3.min([d3.max([s,n,o,d,p]),x])]).range([u,0]).nice(),M=E;const c=d3.area().x((t)=>P(g(t))).y0((t)=>M(V(t))).y1((t)=>M(W(t))).curve(d3.curveBasis),y=d3.area().x((t)=>P(g(t))).y0((t)=>M(U(t))).y1((t)=>M(F(t))).curve(d3.curveBasis),h=d3.area().x((t)=>P(g(t))).y0((t)=>M(Y(t))).y1((t)=>M(X(t))).curve(d3.curveBasis),m=d3.area().x((t)=>P(g(t))).y0((t)=>M(K(t))).y1((t)=>M(J(t))).curve(d3.curveBasis),L=d3.area().x((t)=>P(g(t))).y0((t)=>M(O(t))).y1((t)=>M(Z(t))).curve(d3.curveBasis),_=0.2;R.append('path').attr('class','area-path epsilon-greedy').attr('clip-path','url(#rect-clip-regret)').style('fill',f).style('fill-opacity',_).attr('d',c(t)),R.append('path').attr('class','area-path epsilon-greedy-decay').attr('clip-path','url(#rect-clip-regret)').style('fill',v).style('fill-opacity',_).attr('d',y(t)),R.append('path').attr('class','area-path ucb-basic').attr('clip-path','url(#rect-clip-regret)').style('fill',k).style('fill-opacity',_).attr('d',h(t)),R.append('path').attr('class','area-path thompson-basic').attr('clip-path','url(#rect-clip-regret)').style('fill',w).style('fill-opacity',_).attr('d',m(t)),R.append('path').attr('class','area-path myopic-vpi-basic').attr('clip-path','url(#rect-clip-regret)').style('fill',b).style('fill-opacity',_).attr('d',L(t))}function o(t,e){function a(e){var a;'.line-path.epsilon-greedy'==e?a=B:'.line-path.epsilon-greedy-decay'==e?a=S:'.line-path.ucb-basic'==e?a=D:'.line-path.thompson-basic'==e?a=z:'.line-path.myopic-vpi-basic'==e&&(a=q),R.selectAll(e).transition().duration(G).attr('d',a(t))}M=e?E:A,L=d3.axisLeft(M).ticks(4).tickSize(-m).tickPadding(10).tickFormat(function(t){return 1<=t/1e3&&(t=t/1e3+'K'),t}),_.transition().duration(G).ease(d3.easePoly).call(L),B=d3.line().x((t)=>P(g(t))).y((t)=>M(H(t))).curve(d3.curveBasis),S=d3.line().x((t)=>P(g(t))).y((t)=>M(j(t))).curve(d3.curveBasis),D=d3.line().x((t)=>P(g(t))).y((t)=>M(I(t))).curve(d3.curveBasis),z=d3.line().x((t)=>P(g(t))).y((t)=>M(C(t))).curve(d3.curveBasis),q=d3.line().x((t)=>P(g(t))).y((t)=>M(N(t))).curve(d3.curveBasis),a('.line-path.epsilon-greedy'),a('.line-path.epsilon-greedy-decay'),a('.line-path.ucb-basic'),a('.line-path.thompson-basic'),a('.line-path.myopic-vpi-basic')}const d={top:10,right:0,bottom:10,left:55},p=50,c=40,y=parseInt(d3.select('#Regret').style('width'))-c,h=parseInt(d3.select('#Regret').style('height'))-p,m=y-d.left-d.right,u=h-d.top-d.bottom,x=1.5e5,f=t,v=e,k=a,w=l,b=s;var L,_,M,A,E,P,B,S,D,z,q,G=1e3,T=d3.selectAll('input[name="regret"]:checked').property('value'),Q=d3.select('#Regret').append('svg').attr('width',`${y+c}`).attr('height',`${h+p}`);const R=Q.append('g').attr('class','regret').attr('transform',`translate(${d.left},${d.top})`);Q.append('clipPath').attr('id','rect-clip-regret').append('rect').attr('height',h).attr('width',y);const g=(t)=>t.x,H=(t)=>t.epsilonGreedyMedian,j=(t)=>t.epsilonGreedyDecayMedian,I=(t)=>t.ucbMedian,C=(t)=>t.thompsonMedian,N=(t)=>t.myopicVPIMedian,V=(t)=>t.epsilonGreedyMin,U=(t)=>t.epsilonGreedyDecayMin,Y=(t)=>t.ucbMin,K=(t)=>t.thompsonMin,O=(t)=>t.myopicVPIMin,W=(t)=>t.epsilonGreedyMax,F=(t)=>t.epsilonGreedyDecayMax,X=(t)=>t.ucbMax,J=(t)=>t.thompsonMax,Z=(t)=>t.myopicVPIMax,$=(t)=>{function e(t,e,a,r,l,i){var s='legend-'+t;at.append('circle').attr('cx',r).attr('cy',l).attr('class',s).attr('r',6).style('fill',a).on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mouseout',function(){d3.select(this).style('cursor','default')});const n='#4C4845';at.append('text').attr('x',r+Y).attr('y',l).attr('class',s).text(e).style('font-size','12px').style('fill',n).attr('alignment-baseline','middle').on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mouseout',function(){d3.select(this).style('cursor','default')}),at.selectAll('.'+s).on('click',function(){var e=at.selectAll('.'+s).nodes();0==i%2?(d3.selectAll('.'+t).style('opacity',0),d3.select(e[0]).style('opacity',0.3),d3.select(e[1]).style('fill','#dbdbdb')):1==i%2&&(d3.selectAll('.'+t).style('opacity',1),d3.select(e[0]).style('opacity',1),d3.select(e[1]).style('fill',n)),i+=1})}var a=d3.min(t,H),r=d3.min(t,j),l=d3.min(t,I),i=d3.min(t,C),s=d3.min(t,N),n=d3.max(t,H),o=d3.max(t,j),d=d3.max(t,I),y=d3.max(t,C),h=d3.max(t,N);A=d3.scaleLinear().domain([d3.min([a,r,l,i,s]),d3.min([d3.max([n,o,d,y,h]),x])]).range([u,0]).nice(),M=A,B=d3.line().x((t)=>P(g(t))).y((t)=>M(H(t))).curve(d3.curveBasis),S=d3.line().x((t)=>P(g(t))).y((t)=>M(j(t))).curve(d3.curveBasis),D=d3.line().x((t)=>P(g(t))).y((t)=>M(I(t))).curve(d3.curveBasis),z=d3.line().x((t)=>P(g(t))).y((t)=>M(C(t))).curve(d3.curveBasis),q=d3.line().x((t)=>P(g(t))).y((t)=>M(N(t))).curve(d3.curveBasis);const E=d3.axisBottom(P).ticks(4).tickSize(-u).tickPadding(15).tickFormat(function(t){return 1<=t/1e3&&(t=t/1e3+'K'),t});L=d3.axisLeft(M).ticks(4).tickSize(-m).tickPadding(10).tickFormat(function(t){return 1<=t/1e3&&(t=t/1e3+'K'),t}),_=R.append('g').call(L),_.append('text').attr('class','axis-label').attr('y',-c).attr('x',-u/2).attr('fill','black').attr('transform',`rotate(-90)`).attr('text-anchor','middle').text('Cumulative Regret');const G=R.append('g').call(E).attr('transform',`translate(0,${u})`);G.append('text').attr('class','axis-label').attr('y',p).attr('x',m/2).attr('fill','black').text('Episodes'),R.append('path').attr('class','line-path epsilon-greedy').style('stroke',f).attr('d',B(t)),R.append('path').attr('class','line-path epsilon-greedy-decay').style('stroke',v).attr('d',S(t)),R.append('path').attr('class','line-path ucb-basic').style('stroke',k).attr('d',D(t)),R.append('path').attr('class','line-path thompson-basic').style('stroke',w).attr('d',z(t)),R.append('path').attr('class','line-path myopic-vpi-basic').style('stroke',b).attr('d',q(t));const T=10,Q=160,V=20,U=30,Y=15,K=parseInt(d3.select('#regretLegend').style('height'));if(130==K){const t=10;var O=T+t,W=T+160,F=V,X=T+t,J=V+U,Z=T+160,$=V+U,tt=T+t,et=V+2*U,at=d3.select('#regretLegend').append('svg').attr('width',T+2*Q)}else var O=T,W=T+150,F=V,X=T+315,J=V,Z=T,$=V+U,tt=T+150,et=V+U,at=d3.select('#regretLegend').append('svg').attr('width',2*(T+Q)+120);e('epsilon-greedy','Epsilon Greedy',f,O,V,0),e('epsilon-greedy-decay','Epsilon Greedy (Decay)',v,W,F,0),e('ucb-basic','Bayes-UCB',k,X,J,0),e('thompson-basic','Q-Value Sampling',w,Z,$,0),e('myopic-vpi-basic','Myopic-VPI',b,tt,et,0)},tt=['Epsilon Greedy','Epsilon Greedy Decay','Upper Confidence Bound','Thompson','Myopic-VPI'];var et=[];Promise.all([d3.json('data/regret_distribution_truncated.json')]).then((t)=>{for(var e=t[0],a=0;a<e[tt[0]+' median'].length;a++)et.push({x:a,epsilonGreedyMedian:e[tt[0]+' median'][a],epsilonGreedyDecayMedian:e[tt[1]+' median'][a],ucbMedian:e[tt[2]+' median'][a],thompsonMedian:e[tt[3]+' median'][a],myopicVPIMedian:e[tt[4]+' median'][a],epsilonGreedyMax:e[tt[0]+' max'][a],epsilonGreedyDecayMax:e[tt[1]+' max'][a],ucbMax:e[tt[2]+' max'][a],thompsonMax:e[tt[3]+' max'][a],myopicVPIMax:e[tt[4]+' max'][a],epsilonGreedyMin:e[tt[0]+' min'][a],epsilonGreedyDecayMin:e[tt[1]+' min'][a],ucbMin:e[tt[2]+' min'][a],thompsonMin:e[tt[3]+' min'][a],myopicVPIMin:e[tt[4]+' min'][a]});P=d3.scaleLinear().domain(d3.extent(et,g)).range([0,m]).nice(),$(et),n(et),d3.selectAll('.area-path').style('display','none')}),d3.selectAll('input[name="regret"]').on('change',function(){T=this.value,'range'==T?(o(et,!0),setTimeout(function(){d3.selectAll('.area-path').style('display','block')},G),d3.selectAll('.line-path').raise()):'median'==T&&(o(et,!1),d3.selectAll('.area-path').style('display','none'))})}function p(t,e,a){function r(){for(var a=[],l=1,i=1,s=0;s<e;s++){a.push([]);for(var n=0;n<t;n++){if(0==s){if(n==t-1)var o=h;else if(0!=n)var o=m;else var o=u;}else if(s>=w&&s<w+_&&n>=x&&n<x+L)var o=M.reward;else var o=u;a[s].push({x:l,y:i,width:p,height:c,reward:o}),l+=p+d}l=1,i+=c+d}return a}function l(t,e,a){return f(-v(t-e,2)/(2*v(a,2)))/(a*k(2*g))}function i(t,e){var a=[];for(var r=t-R;r<t+R;r+=0.5)a.push({x:r,y:l(r,t,e)});return a}function s(){function r(t){const e=`(${t[0]}, ${t[1]}) `,a=q[e+'Up'],r=q[e+'Left'],l=q[e+'Right'],i=q[e+'Down'];var s;const n=d3.max([a,r,l,i]);return a==n?s=[t[0]-1,t[1]]:r==n?s=[t[0],t[1]-1]:l==n?s=[t[0],t[1]+1]:i==n&&(s=[t[0]+1,t[1]]),s}var l=d3.scaleLinear().domain([0,t]).range([0,y*t]),i=d3.scaleLinear().domain([e,0]).range([y*e,0]),s=d3.line().x(function(t){return l(t[1]+0.5)}).y(function(t){return i(t[0]+0.5)}).curve(d3.curveBasis);const n=2;C.append('defs').append('marker').attr('id','arrow-path-end-dist').attr('viewBox',[0,0,n,n]).attr('refX',n/2).attr('refY',n/2).attr('markerWidth',n).attr('markerHeight',n).attr('orient','auto-start-reverse').append('path').attr('d',d3.line()([[0,0],[0,n],[n,n/2]])).attr('fill',a).style('opacity',1);var o=function(){for(var e=[0,0],a=[e],l=!1;!l;)0==e[0]&&e[1]==t-1?l=!0:0==e[0]&&0!=e[1]?l=!0:(e=r(e),a.push(e));return a}(),d=C.append('path').datum(o).attr('d',s).style('stroke',a).style('stroke-width',10).style('fill','none').style('opacity',0.65).attr('class','exploitation-path').attr('marker-end','url(#arrow-path-end-dist)')}const n=parseInt(d3.select('#containerGridDistributions').style('height')),o=parseInt(d3.select('#containerGridDistributions').style('width')),d=2,p=b((o-(t-1)*d)/t),c=p,y=p+d,h=50,m=-h,u=-2,x=1,w=1,L=2,_=3;var M={x:x*y,y:w*y,width:(p+d)*L,height:(c+d)*_,reward:-15,click:0},A=d3.scaleLinear().range(['#ff6961','#eee','#66cc66']).domain([m,0,h]),r=r();const E=r[0][0].y,P=r[0][0].x,B=r[0][t-1].x,S=r[e-1][0].y,D=d3.select('body').append('g').attr('class','mytooltip');D.append('svg').attr('class','tooltipRobot');const z=['Up','Left','Right','Down'];var q={},G={};Promise.all([d3.json('data/Qmu.json'),d3.json('data/Qsigma.json')]).then((r)=>{for(var l,i=r[0],n=r[1],o=0;o<t;o++)for(var d=0;d<e;d++)for(var p of z)l='('+d+', '+o+') '+p,q[l]=i[l],G[l]=n[l];s()});var T=50,Q=-T,R=30,H=d3.scaleLinear().range(['red','#F4C2C2','white','#B2EC5D','green']).domain([Q,-1,0,1,T]);const j=d3.select('.tooltipRobot'),I=function(t,e){function a(t,e){var a,r;return'x'==e?(a=n,r=[0,h]):'y'==e&&(a=o,r=[m,0]),d3.scaleLinear().domain(d3.extent(t,a)).range(r).nice()}function r(t,e,a,r){t.append('linearGradient').attr('id',r).attr('gradientUnits','userSpaceOnUse').attr('x1','0%').attr('y1','0%').attr('x2','100%').attr('y2','0%').selectAll('stop').data([{offset:'0%',color:H(e)},{offset:'50%',color:H((a-e)/2)},{offset:'100%',color:H(a)}]).enter().append('stop').attr('offset',function(t){return t.offset}).attr('stop-color',function(t){return t.color})}function l(t,e,l){const i=a(e,'x'),s=a(e,'y'),d=d3.line().x((t)=>i(n(t))).y((t)=>s(o(t))).curve(d3.curveBasis),p='distribution-gradient-'+l;return d3.select(`#${p}`).remove(),r(t,d3.min(e,(t)=>t.x),d3.max(e,(t)=>t.x),p),t.append('path').attr('stroke-width',3).attr('fill','none').attr('class','normal-distribution').attr('d',d(e)).attr('stroke',`url(#${p})`)}function s(t,e,a){return'('+(e-1)/(c+d)+', '+(t-1)/(p+d)+') '+a}const n=(t)=>t.x,o=(t)=>t.y,y={top:5,right:5,bottom:5,left:5},h=200/4,m=200/4,u=75,x=75,g=d3.scaleLinear().domain([Q,T]).range([0,h]).nice();if(j.selectAll('.normal-distribution').remove(),!1==(e==E&&t!=P)){if(e!=E){const a=s(t,e,'Up'),r=i(q[a],G[a]),n=j.append('g').attr('transform',`translate(${u},${y.top})`),o=l(n,r,'up')}if(t!=P){const a=s(t,e,'Left'),r=i(q[a],G[a]),n=j.append('g').attr('transform',`translate(${y.left},${x})`),o=l(n,r,'left')}if(t!=B){const a=s(t,e,'Right'),r=i(q[a],G[a]),n=j.append('g').attr('transform',`translate(${150-y.right},${x})`),o=l(n,r,'right')}if(e!=S){const a=s(t,e,'Down'),r=i(q[a],G[a]),n=j.append('g').attr('transform',`translate(${u},${150-y.bottom})`),o=l(n,r,'down')}}};var C=d3.select('#containerGridDistributions').append('svg').attr('width',`${o}px`).attr('height',`${n}px`),N=C.selectAll('.row').data(r).enter().append('g').attr('class','row'),V=N.selectAll('.square').data(function(t){return t}).enter().append('rect').attr('class','square').attr('x',function(t){return t.x}).attr('y',function(t){return t.y}).attr('width',function(t){return t.width}).attr('height',function(t){return t.height}).style('fill',function(t){return A(t.reward)}).style('stroke','none').style('stroke-width',3).on('mouseover',function(t){I(t.x,t.y),d3.select(this).style('stroke','#24B3A8').style('rx',5).style('cursor','pointer'),D.style('visibility','visible')}).on('mouseout',function(){d3.select(this).style('stroke','none').style('rx',0),D.style('visibility','hidden')}).on('mousemove',function(t){if(t.y>y*e/2)var a=-230;else var a=20;D.style('top',event.pageY+a+'px').style('left',event.pageX+-110+'px')}),U=C.append('rect').attr('x',M.x).attr('y',M.y).attr('width',M.width).attr('height',M.height).style('fill','none').style('stroke','red').style('stroke-width',3).style('stroke-dasharray','4, 4');const Y=(t)=>{d3.select('.tooltipRobot').append(function(){return t.documentElement.cloneNode(!0)}).attr('x',60).attr('y',60)};d3.xml('assets/robotWithArrows.svg').then((t)=>{Y(t)})}function c(t,e,a,r,l,i,s){function n(){for(var t=[],e=1,l=1,i=0;i<r;i++){t.push([]);for(var s=0;s<a;s++){if(0==i){if(s==a-1)var o=x;else if(0!=s)var o=g;else var o=f;}else if(i>=k&&i<k+L&&s>=v&&s<v+w)var o=_.reward;else var o=f;t[i].push({x:e,y:l,width:h,height:m,reward:o,click:0}),e+=h+y}e=1,l+=m+y}return t}function o(t,e){return`(${(e-1)/(m+y)}, ${(t-1)/(h+y)})`}function d(e){const a=`(${e[0]}, ${e[1]}) `,r=4999,l=t[a+'Up'][r].mu,i=t[a+'Left'][r].mu,s=t[a+'Right'][r].mu,n=t[a+'Down'][r].mu;var o;const d=d3.max([l,i,s,n]);return l==d?o=[e[0]-1,e[1]]:i==d?o=[e[0],e[1]-1]:s==d?o=[e[0],e[1]+1]:n==d&&(o=[e[0]+1,e[1]]),o}const p=parseInt(d3.select('.learning-progress').style('height')),c=parseInt(d3.select('#gridLearningProgress').style('width')),y=2,h=b((c-(a-1)*y)/a),m=h,u=h+y,x=50,g=-x,f=-2,v=1,k=1,w=2,L=3;var _={x:v*u,y:k*u,width:(h+y)*w,height:(m+y)*L,reward:-15,click:0},M=d3.scaleLinear().range(['#ff6961','#eee','#66cc66']).domain([g,0,x]);const A=i,E=l,P=s,B=5,S={top:5,right:20,bottom:35,left:20},D=parseInt(d3.select('#chartLearningProgress').style('width')),z=10,q=35,G=D-S.left-S.right,T=p-S.top-S.bottom-z-5,Q=parseInt(d3.select('#actionsLearningProgress').style('width')),R=parseInt(d3.select('#actionsLearningProgress').style('height')),H=50,j=50;var I='(0, 0)',n=n(),C=d3.select('#gridLearningProgress').append('svg').attr('width',`${c}px`).attr('height',`${p}px`),N=d3.select('#chartLearningProgress').append('svg').attr('width',`${D+q}px`).attr('height',`${p}px`),V=d3.select('#actionsLearningProgress').append('svg').attr('width',`${Q}px`).attr('height',`${R}px`),U=C.selectAll('.row').data(n).enter().append('g').attr('class','row'),Y=U.selectAll('.square').data(function(t){return t}).enter().append('rect').attr('class','square').attr('x',function(t){return t.x}).attr('y',function(t){return t.y}).attr('width',function(t){return t.width}).attr('height',function(t){return t.height}).style('fill',function(t){return M(t.reward)}).style('stroke',function(t){return o(t.x,t.y)==I?A:'none'}).style('rx',function(t){return o(t.x,t.y)==I?B:0}).style('stroke-width',3).on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mouseout',function(){d3.select(this).style('cursor','default')}).on('click',function(e){I=o(e.x,e.y),e.click++,d3.selectAll('.square').style('stroke','none').style('rx',0),0==e.click%2?d3.select(this).style('stroke','none').style('rx',0):1==e.click%2&&d3.select(this).style('stroke',A).style('rx',B),d3.select('.QProgress').remove(),rt(t[`${I} ${et}`]),e.click--}),K=C.append('rect').attr('x',_.x).attr('y',_.y).attr('width',_.width).attr('height',_.height).style('fill','none').style('stroke','red').style('stroke-width',3).style('stroke-dasharray','4, 4'),O=d3.scaleLinear().domain([0,a]).range([0,u*a]),W=d3.scaleLinear().domain([r,0]).range([u*r,0]);const F=l;var X=d3.line().x(function(t){return O(t[1]+0.5)}).y(function(t){return W(t[0]+0.5)}).curve(d3.curveBasis);const J=2;C.append('defs').append('marker').attr('id','arrow-path-end').attr('viewBox',[0,0,J,J]).attr('refX',J/2).attr('refY',J/2).attr('markerWidth',J).attr('markerHeight',J).attr('orient','auto-start-reverse').append('path').attr('d',d3.line()([[0,0],[0,J],[J,J/2]])).attr('fill',F).style('opacity',1);var Z=function(){for(var t=[0,0],e=[t],r=!1;!r;)0==t[0]&&t[1]==a-1?r=!0:0==t[0]&&0!=t[1]?r=!0:(t=d(t),e.push(t));return e}(),$=C.append('path').datum(Z).attr('d',X).style('stroke',F).style('stroke-width',10).style('fill','none').style('opacity',0.65).attr('class','exploitation-path').attr('marker-end','url(#arrow-path-end)'),tt=0,et='Down';const at=(e,a,r,l)=>{const i=V.append(function(){return e.documentElement.cloneNode(!0)}).attr('x',a+10).attr('y',r-R/2).attr('width',50).style('stroke-width',8).style('stroke',function(){return l==et?A:'none'}).attr('class','arrows').on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mouseout',function(){d3.select(this).style('cursor','default')}).on('click',function(){et=l,tt++,d3.selectAll('.arrows').style('stroke','none'),d3.selectAll('.arrows path').style('fill',P),0==tt%2?d3.select(this).style('stroke','none'):1==tt%2&&(d3.select(this).style('stroke',A),d3.select(this).selectAll('path').style('fill',E)),d3.select('.QProgress').remove(),rt(t[`${I} ${et}`]),tt--});i.selectAll('path').style('fill',function(){return l==et?E:P})};Promise.all([d3.xml('assets/upArrow.svg'),d3.xml('assets/leftArrow.svg'),d3.xml('assets/rightArrow.svg'),d3.xml('assets/downArrow.svg')]).then((t)=>{const e=t[0],a=t[1],r=t[2],l=t[3];at(e,H,-j,'Up'),at(a,0,0,'Left'),at(r,2*H,0,'Right'),at(l,H,j,'Down')});const rt=(t)=>{const e=(t)=>t.x,a=(t)=>t.mu,r=(t)=>t.mu+t.sigma,l=(t)=>t.mu-t.sigma,s=d3.scaleLinear().domain(d3.extent(t,e)).range([0,G]).nice();var n=d3.extent(t,r),o=d3.extent(t,l),d=d3.extent(t,(t)=>t.true_mu+t.true_sigma),p=d3.extent(t,(t)=>t.true_mu-t.true_sigma);const c=d3.scaleLinear().domain([d3.min([o[0],p[0]]),d3.max([n[1],d[1]])]).range([T,0]).nice(),y=N.append('g').attr('class','QProgress').attr('transform',`translate(${S.left+q}, ${S.top})`),h=d3.axisBottom(s).ticks(5).tickSize(-T).tickPadding(15).tickFormat(function(t){return 1<=t/1e3&&(t=t/1e3+'K'),t}),m=d3.axisLeft(c).ticks(4).tickSize(-G).tickPadding(10),u=y.append('g').call(m);u.append('text').attr('class','axis-label').attr('y',-q).attr('x',-T/2).attr('fill','black').attr('transform',`rotate(-90)`).attr('text-anchor','middle').text('Q-Value');const x=y.append('g').call(h).attr('transform',`translate(0,${T})`);if(x.append('text').attr('class','axis-label').attr('y',z+35).attr('x',G/2).attr('fill','black').text('Episodes'),0!=I[1]||0==I[4]){const n=d3.line().x((t)=>s(e(t))).y((t)=>c(a(t))).curve(d3.curveBasis),o=d3.area().x((t)=>s(e(t))).y0((t)=>c(l(t))).y1((t)=>c(r(t))).curve(d3.curveBasis);y.append('path').attr('class','area-path').style('fill',i).style('fill-opacity',0.3).attr('d',o(t)),y.append('path').attr('class','line-path').style('stroke-width',2).style('stroke',i).attr('d',n(t))}};rt(t[`${I} ${et}`])}function y(t,e){function a(a){for(var r,l=[],i=1,s=1,n=0;n<e;n++){l.push([]);for(var c=0;c<t;c++)r='('+n+', '+c+')',l[n].push({x:i,y:s,width:d,height:p,optimal_visitations:a[r].optimal_visitations,suboptimal_visitations:a[r].suboptimal_visitations}),i+=d+o;i=1,s+=p+o}return l}function r(a,r){const l=2;for(var i=1,s=1,n=0;n<e;n++){for(var c=0;c<t;c++)if(1==n&&1==c){a.append(function(){return r.documentElement.cloneNode(!0)}).attr('y',s+l).attr('x',i+l).attr('width',0.9*d).attr('height',0.9*d)}i=1,s+=p+o}}function l(t,e){return`(${(e-1)/(p+o)}, ${(t-1)/(d+o)})`}function i(a,i,s){var x;'optimal_visitations'==s?x='#optimalStateVisitations':'suboptimal_visitations'==s&&(x='#suboptimalStateVisitations');var g,f,v=d3.select(x).append('svg').attr('width',`${c*t}`).attr('height',`${c*e}`);'optimal_visitations'==s?(g=y,f='Optimal (Expected Value = 18)'):'suboptimal_visitations'==s&&(g=h,f='Suboptimal (Expected Value = 4)',v.attr('x',`${n}`));var k=v.selectAll('.row').data(a).enter().append('g').attr('class','row'),w=k.selectAll('.square').data(function(t){return t}).enter().append('rect').attr('class','square').attr('x',function(t){return t.x}).attr('y',function(t){return t.y}).attr('width',function(t){return t.width}).attr('height',function(t){return t.height}).style('fill',function(t){return g(t[s])}).style('stroke','none').style('rx',function(t){return l(t.x,t.y)==u?m:0}).style('stroke-width',2);var b={x:1*c,y:1*c,width:(d+o)*2,height:(p+o)*3,reward:-15,click:0},L=v.append('rect').attr('x',b.x).attr('y',b.y).attr('width',b.width).attr('height',b.height).style('fill','none').style('stroke','red').style('stroke-width',3).style('stroke-dasharray','4, 4');r(v,i),v.append('text').attr('class','axis-label').attr('y',p/2).attr('x',n/2).attr('fill','black').attr('text-anchor','middle').text(f)}const s=parseInt(d3.select('.state-visitations').style('height')),n=parseInt(d3.select('.state-visitations').style('width')),o=2,d=b((n-(t-1)*o)/t),p=d,c=d+o;var y=d3.scaleLinear().range(['white','#66cc66']).domain([0,10000]),h=d3.scaleLinear().range(['white','#ff6961']).domain([0,10000]);const m=5;var u='(1, 0)',x={};Promise.all([d3.json('data/optimal_policy_state_visitations.json'),d3.json('data/suboptimal_policy_state_visitations.json'),d3.xml('assets/star.svg')]).then((r)=>{for(var l,s=r[0],n=r[1],o=r[2],d=0;d<t;d++)for(var p=0;p<e;p++)l='('+p+', '+d+')',x[l]={optimal_visitations:s[l].visitations,suboptimal_visitations:n[l].visitations};var c=a(x);i(c,o,'optimal_visitations',18),i(c,o,'suboptimal_visitations',4)})}function h(t,e,r){function l(t,e){var a=l.canvas||(l.canvas=document.createElement('canvas')),r=a.getContext('2d');r.font=e;var i=r.measureText(t);return i.width}function i(t,e){for(var r=[],l=t-4*e;l<t+4*e;l+=0.05)r.push({mu:l,density:a(l,t,e)});return r}function s(t){const e=[];for(var a=0;a<=L;a++)e.push({x:t,y:a});return e}const n='bold 12pt arial',o='Probability Above',d=l(o,n),p='Joint Density',c=l(p,n),y=d3.max([d,c]),h=y-d3.min([d,c]);var m=20,u=parseInt(d3.select('.exploration-exploitation').style('height')),x=parseInt(d3.select('#distributionsExplorationExploitation').style('width')),g=parseInt(d3.select('.probability-bar').style('height')),f=parseInt(d3.select('.probability-bar').style('width'))-m-y,v=+d3.select('#sliderExplorationExploitation').attr('value'),k=1,w=1,b=10,L=10;document.querySelector('label[for="barExplorationExploitation"] span').innerHTML=v;var _=i(v,k),M=i(0,w),A=d3.scaleLinear().domain([-b-4*w,b+4*w]).range([0,x]),E=d3.scaleLinear().domain([0,1]).range([0,f]),P=d3.scaleLinear().domain([0,d3.max(M,function(t){return t.density})]).range([u,0]),B=d3.scaleLinear().domain([0,L]).range([g,0]),S=d3.axisBottom(A),D=d3.axisBottom(E),z=d3.axisLeft(P),q=d3.axisLeft(B),G=d3.select('#distributionsExplorationExploitation').append('svg').attr('width',x).attr('height',u).attr('style','border-bottom: 1.5px solid grey;'),T=d3.select('#probAboveExplorationExploitation').append('svg').attr('width',f+m+y).attr('height',g).append('g').attr('transform',`translate(${m+y},${0})`);T.append('g').append('text').attr('transform',`translate(${-m-y},${0})`).attr('y',0.75*g).style('font',n).style('text-anchor','start').text(o);var Q=T.append('rect').attr('width',f).attr('height',g).style('fill','none').style('stroke','grey').style('stroke-width','2px'),R=d3.select('#probJointExplorationExploitation').append('svg').attr('width',f+m+y).attr('height',g).append('g').attr('transform',`translate(${m+y},${0})`);R.append('g').append('text').attr('transform',`translate(${-m-y},${0})`).attr('y',0.75*g).style('font',n).style('text-anchor','start').text(p);var H=R.append('rect').attr('width',f).attr('height',g).style('fill','none').style('stroke','grey').style('stroke-width','2px'),j=d3.area().x(function(t){return A(t.mu)}).y0(u).y1(function(t){return P(t.density)}).curve(d3.curveBasis),I=d3.area().x0(0).x1(function(t){return E(t.x)}).y(function(t){return B(t.y)}).curve(d3.curveBasis),C=d3.line().x(function(t){return E(t.x)}).y(function(t){return B(t.y)}).curve(d3.curveBasis);Promise.all([d3.json('data/exploration_exploitation.json')]).then((a)=>{function l(){_=i(v,k),o=n[`${v}`].probability_above,d=n[`${v}`].probability_overlap,p=s(o),c=s(d),y.remove(),m.remove(),u.remove(),x.remove(),g.remove(),y=G.append('path').datum(_).attr('d',j).style('stroke',t).style('fill',t).style('fill-opacity',0.3).attr('class','line'),m=T.append('path').datum(p).attr('d',I).style('fill',e).style('fill-opacity',0.5),u=T.append('path').datum(p).attr('d',C).style('stroke',e).style('stroke-width',4).attr('class','line'),x=R.append('path').datum(c).attr('d',I).style('fill',e).style('fill-opacity',0.5),g=R.append('path').datum(c).attr('d',C).style('stroke',e).style('stroke-width',4).attr('class','line')}const n=a[0];var o=n[`${v}`].probability_above,d=n[`${v}`].probability_overlap,p=s(o),c=s(d),y=G.append('path').datum(_).attr('d',j).style('stroke',t).style('fill',t).style('fill-opacity',0.3).attr('class','line'),h=G.append('path').datum(M).attr('d',j).style('stroke',r).style('fill',r).style('fill-opacity',0.3).attr('class','line'),m=T.append('path').datum(p).attr('d',I).style('fill',e).style('fill-opacity',0.5),u=T.append('path').datum(p).attr('d',C).style('stroke',e).style('stroke-width',4).attr('class','line'),x=R.append('path').datum(c).attr('d',I).style('fill',e).style('fill-opacity',0.5),g=R.append('path').datum(c).attr('d',C).style('stroke',e).style('stroke-width',4).attr('class','line');d3.select('#sliderExplorationExploitation').on('input',function(){v=+this.value,document.querySelector('label[for="barExplorationExploitation"] span').innerHTML=v,l()})})}function m(t,e,r){function l(t,e){var a=l.canvas||(l.canvas=document.createElement('canvas')),r=a.getContext('2d');r.font=e;var i=r.measureText(t);return i.width}function i(t,e){for(var r=[],l=t-4*e;l<t+4*e;l+=0.05)r.push({mu:l,density:a(l,t,e)});return r}function s(t){const e=[];for(var a=0;a<=M;a++)e.push({x:t,y:a});return e}function n(t){for(var e=[],a=0;500>a;a++)e.push({e:a,mu_down:t[a].mu_down,sigma_down:t[a].sigma_down,mu_right:t[a].mu_right,sigma_right:t[a].sigma_right});return e}const o='bold 12pt arial',d='Probability Above',p=l(d,o),c='Joint Density',y=l(c,o),h=d3.max([p,y]),u=h-d3.min([p,y]);var x={top:50,right:5,bottom:50,left:60},m=20,g=350-x.top-x.bottom,f=350-x.left-x.right,v=parseInt(d3.select('.probability-bar').style('height')),k=parseInt(d3.select('.probability-bar').style('width'))-m-h-x.right,w=+d3.select('#sliderInflectionEpisode').attr('value')-1,b=+d3.select('#sliderInflectionEpisode').attr('max')-1,L=50,_=-L,M=10;document.querySelector('label[for="barInflectionEpisode"] span').innerHTML=w+1,Promise.all([d3.json('data/optimal_exploration_exploitation.json'),d3.json('data/suboptimal_exploration_exploitation.json')]).then((a)=>{function l(){B=u[`${w}`].mu_down,S=u[`${w}`].sigma_down,D=u[`${w}`].mu_right,z=u[`${w}`].sigma_right,q=i(B,S),G=i(D,z),T=u[`${w}`].probability_above,Q=u[`${w}`].probability_overlap,R=s(T),H=s(Q),yt.remove(),ht.remove(),wt.remove(),bt.remove(),Lt.remove(),_t.remove(),mt.remove(),ut.remove(),xt.remove(),gt.remove(),ft.remove(),vt.remove(),kt.remove(),yt=J.append('path').datum(q).attr('d',rt).attr('clip-path','url(#rect-clip)').style('stroke',t).style('fill',t).style('fill-opacity',0.3).attr('class','line'),ht=J.append('path').datum(G).attr('d',rt).attr('clip-path','url(#rect-clip)').style('stroke',r).style('fill',r).style('fill-opacity',0.3).attr('class','line'),mt=Z.append('path').datum(M).attr('d',lt).style('stroke','none').style('fill',t).style('fill-opacity',0.15),ut=Z.append('path').datum(M).attr('d',it).style('stroke','none').style('fill',r).style('fill-opacity',0.15),xt=Z.append('path').datum(M).attr('d',st).style('stroke','none').style('fill',t).style('fill-opacity',0.15),gt=Z.append('path').datum(M).attr('d',nt).style('stroke','none').style('fill',r).style('fill-opacity',0.15),ft=Z.append('path').datum(M).attr('d',ot).style('stroke',t).style('stroke-width',1.5).attr('class','line'),vt=Z.append('path').datum(M).attr('d',dt).style('stroke',r).style('stroke-width',1.5).attr('class','line'),kt=Z.append('line').attr('x1',I(w)).attr('y1',0).attr('x2',I(w)).attr('y2',g).style('stroke','black').style('stroke-width',2).style('class','line'),wt=$.append('path').datum(R).attr('d',pt).style('fill',e).style('fill-opacity',0.5),bt=$.append('path').datum(R).attr('d',ct).style('stroke',e).style('stroke-width',4).attr('class','line'),Lt=et.append('path').datum(H).attr('d',pt).style('fill',e).style('fill-opacity',0.5),_t=et.append('path').datum(H).attr('d',ct).style('stroke',e).style('stroke-width',4).attr('class','line')}const p=a[0],y=a[1];var u,M,A=n(p),E=n(y),P=d3.selectAll('input[name = \'inflection-point\']').attr('value');'optimal'==P?(u=p,M=A):'suboptimal'==P&&(u=y,M=E);var B=u[`${w}`].mu_down,S=u[`${w}`].sigma_down,D=u[`${w}`].mu_right,z=u[`${w}`].sigma_right,q=i(B,S),G=i(D,z),T=u[`${w}`].probability_above,Q=u[`${w}`].probability_overlap,R=s(T),H=s(Q),j=d3.scaleLinear().domain([_,L]).range([0,f]).nice(),I=d3.scaleLinear().domain([0,b]).range([0,f]).nice(),C=d3.scaleLinear().domain([0,1]).range([0,k]),N=d3.scaleLinear().domain([0,0.1]).range([g,0]).nice(),V=d3.scaleLinear().domain([-50,50]).range([g,0]).nice(),U=d3.scaleLinear().domain([0,1]).range([v,0]),Y=d3.axisBottom(j).ticks(5).tickSize(0).tickPadding(15),K=d3.axisBottom(I).ticks(5).tickSize(0).tickPadding(15).tickFormat(function(t){return 1<=t/1e3&&(t=t/1e3+'K'),t}),O=d3.axisBottom(C),W=d3.axisLeft(N).ticks(6).tickSize(0).tickPadding(15),F=d3.axisLeft(V).ticks(6).tickSize(0).tickPadding(15),X=d3.axisLeft(U),J=d3.select('#distributionsInflectionPoint').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${g+x.top+x.bottom} ${f+x.left+x.right}`).classed('svg-content-responsive',!0).append('g').attr('transform','translate('+x.left+','+x.top+')');J.append('clipPath').attr('id','rect-clip').append('rect').attr('height',g).attr('width',f);var Z=d3.select('#progressInflectionPoint').classed('svg-container',!0).append('svg').attr('preserveAspectRatio','xMinYMin meet').attr('viewBox',`0 0 ${g+x.top+x.bottom} ${f+x.left+x.right}`).classed('svg-content-responsive',!0).append('g').attr('transform','translate('+x.left+','+x.top+')'),$=d3.select('#probAboveInflectionPoint').append('svg').attr('width',k+m+h+x.right).attr('height',v).append('g').attr('transform',`translate(${m+h},${0})`);$.append('g').append('text').attr('transform',`translate(${-m-h},${0})`).attr('y',0.75*v).style('font',o).style('text-anchor','start').text(d);var tt=$.append('rect').attr('width',k).attr('height',v).style('fill','none').style('stroke','grey').style('stroke-width','2px'),et=d3.select('#probJointInflectionPoint').append('svg').attr('width',k+m+h+x.right).attr('height',v).append('g').attr('transform',`translate(${m+h},${0})`);et.append('g').append('text').attr('transform',`translate(${-m-h},${0})`).attr('y',0.75*v).style('font',o).style('text-anchor','start').text(c);var at=et.append('rect').attr('width',k).attr('height',v).style('fill','none').style('stroke','grey').style('stroke-width','2px'),rt=d3.line().x(function(t){return j(t.mu)}).y(function(t){return N(t.density)}).curve(d3.curveBasis),lt=d3.area().x(function(t){return I(t.e)}).y0(function(t){return V(d3.max([_,t.mu_down-t.sigma_down]))}).y1(function(t){return V(d3.min([L,t.mu_down+t.sigma_down]))}).curve(d3.curveBasis),it=d3.area().x(function(t){return I(t.e)}).y0(function(t){return V(d3.max([_,t.mu_right-t.sigma_right]))}).y1(function(t){return V(d3.min([L,t.mu_right+t.sigma_right]))}).curve(d3.curveBasis),st=d3.area().x(function(t){return I(t.e)}).y0(function(t){return V(d3.max([_,t.mu_down-2*t.sigma_down]))}).y1(function(t){return V(d3.min([L,t.mu_down+2*t.sigma_down]))}).curve(d3.curveBasis),nt=d3.area().x(function(t){return I(t.e)}).y0(function(t){return V(d3.max([_,t.mu_right-2*t.sigma_right]))}).y1(function(t){return V(d3.min([L,t.mu_right+2*t.sigma_right]))}).curve(d3.curveBasis),ot=d3.line().x(function(t){return I(t.e)}).y(function(t){return V(t.mu_down)}).curve(d3.curveBasis),dt=d3.line().x(function(t){return I(t.e)}).y(function(t){return V(t.mu_right)}).curve(d3.curveBasis),pt=d3.area().x0(0).x1(function(t){return C(t.x)}).y(function(t){return U(t.y)}).curve(d3.curveBasis),ct=d3.line().x(function(t){return C(t.x)}).y(function(t){return U(t.y)}).curve(d3.curveBasis),yt=J.append('path').datum(q).attr('d',rt).attr('clip-path','url(#rect-clip)').style('stroke',t).style('fill',t).style('fill-opacity',0.3).attr('class','line'),ht=J.append('path').datum(G).attr('d',rt).attr('clip-path','url(#rect-clip)').style('stroke',r).style('fill',r).style('fill-opacity',0.3).attr('class','line'),mt=Z.append('path').datum(M).attr('d',lt).style('stroke','none').style('fill',t).style('fill-opacity',0.15),ut=Z.append('path').datum(M).attr('d',it).style('stroke','none').style('fill',r).style('fill-opacity',0.15),xt=Z.append('path').datum(M).attr('d',st).style('stroke','none').style('fill',t).style('fill-opacity',0.15),gt=Z.append('path').datum(M).attr('d',nt).style('stroke','none').style('fill',r).style('fill-opacity',0.15),ft=Z.append('path').datum(M).attr('d',ot).style('stroke',t).style('stroke-width',1.5).attr('class','line'),vt=Z.append('path').datum(M).attr('d',dt).style('stroke',r).style('stroke-width',1.5).attr('class','line'),kt=Z.append('line').attr('x1',I(w)).attr('y1',0).attr('x2',I(w)).attr('y2',g).style('stroke','black').style('stroke-width',2).style('class','line'),wt=$.append('path').datum(R).attr('d',pt).style('fill',e).style('fill-opacity',0.5),bt=$.append('path').datum(R).attr('d',ct).style('stroke',e).style('stroke-width',4).attr('class','line'),Lt=et.append('path').datum(H).attr('d',pt).style('fill',e).style('fill-opacity',0.5),_t=et.append('path').datum(H).attr('d',ct).style('stroke',e).style('stroke-width',4).attr('class','line');d3.select('#sliderInflectionEpisode').on('input',function(){w=+this.value-1,document.querySelector('label[for="barInflectionEpisode"] span').innerHTML=w+1,l()}),d3.selectAll('input[name = \'inflection-point\']').on('change',function(){P=this.value,console.log(P),'optimal'==P?(u=p,M=A):'suboptimal'==P&&(u=y,M=E),l()});const Mt=20,At=100,Et=12,Pt=20;var Bt=d3.select('#inflectionLegend').append('svg').attr('width',Mt+At+70);Bt.append('circle').attr('cx',Mt).attr('cy',Et).attr('r',6).style('fill',t),Bt.append('circle').attr('cx',Mt+At).attr('cy',Et).attr('r',6).style('fill',r);const St='#4C4845';Bt.append('text').attr('x',Mt+Pt).attr('y',Et).text('Down').style('font-size','16px').style('fill',St).attr('alignment-baseline','middle'),Bt.append('text').attr('x',Mt+At+Pt).attr('y',Et).text('Right').style('font-size','16px').style('fill',St).attr('alignment-baseline','middle');const Dt=45,zt=35;J.append('g').attr('class','x axis').attr('transform','translate(0,'+g+')').call(Y).append('text').attr('class','axis-label').attr('y',Dt).attr('x',f/2).attr('fill','black').text('Q-Value'),Z.append('g').attr('class','x axis').attr('transform','translate(0,'+g+')').call(K).append('text').attr('class','axis-label').attr('y',Dt).attr('x',f/2).attr('fill','black').text('Episodes'),J.append('g').attr('class','y axis').call(W).append('text').attr('class','axis-label').attr('y',-(zt+10)).attr('x',-g/2).attr('fill','black').attr('transform',`rotate(-90)`).attr('text-anchor','middle').text('Density'),Z.append('g').attr('class','y axis').call(F).append('text').attr('class','axis-label').attr('y',-zt).attr('x',-g/2).attr('fill','black').attr('transform',`rotate(-90)`).attr('text-anchor','middle').text('Q-Value')})}function u(t,r,a,l,i){function s(t,e){N.append(function(){return t.documentElement.cloneNode(!0)}).attr('y',e[0]*g+f).attr('x',e[1]*g+f).attr('width',0.9*u).attr('height',0.9*u)}function n(e,a){var l=!0;return'Up'==a&&0>e[0]?l=!1:'Left'==a&&0>e[1]?l=!1:'Right'==a&&e[1]>t-1?l=!1:'Down'==a&&e[0]>r-1&&(l=!1),l}function o(t,a,r){const l=`(${t[0]}, ${t[1]}) `,i=e(a[l+'Up'],r[l+'Up']),s=e(a[l+'Left'],r[l+'Left']),o=e(a[l+'Right'],r[l+'Right']),d=e(a[l+'Down'],r[l+'Down']);var p,c;const y=d3.max([i,s,o,d]);return i==y?(p=[t[0]-1,t[1]],c='Up'):s==y?(p=[t[0],t[1]-1],c='Left'):o==y?(p=[t[0],t[1]+1],c='Right'):d==y&&(p=[t[0]+1,t[1]],c='Down'),n(p,c)?p:t}function d(e,a,l){for(var i=e,s=[i],n=!1;!n;)0==i[0]&&i[1]==t-1?n=!0:0==i[0]&&0!=i[1]?n=!0:s.length==t*r?n=!0:(i=o(i,a,l),s.push(i));return s}function p(e){C.append('path').datum(e).attr('d',Z).style('stroke',J).style('stroke-width',10).style('fill','none').style('opacity',0.35).attr('class','agent-path').transition().duration(H).attrTween('d',function(){var a=d3.scaleQuantile().domain([0,1]).range(d3.range(1,e.length+1));return function(r){return Z(e.slice(0,a(r)))}})}function c(t,e,a){for(var r,l,i=0;i<R;i++)r=H*i-0.1*H,setTimeout(function(){l=d(t,e,a),p(l)},r)}const y=parseInt(d3.select('#containerInflectionPointPaths').style('height')),h=parseInt(d3.select('#containerInflectionPointPaths').style('width')),m=2,u=b((h-(t-1)*m)/t),x=u,g=u+m,f=3,v=50,k=-v,w=-2,L=1,_=1,M=2,A=3;var E={x:L*g,y:_*g,width:(u+m)*M,height:(x+m)*A,reward:-15,click:0},P=d3.scaleLinear().range(['#ff6961','#eee','#66cc66']).domain([k,0,v]);const B=i,S=a,D=l,z=0.8*u;var q=[1,0];const G=['Up','Left','Right','Down'];var T={},Q={},R=10;const H=1e3;var j,I=function(){for(var e,a=[],l=1,i=1,s=0;s<r;s++){a.push([]);for(var n=0;n<t;n++)e=0==s?n==t-1?v:0==n?w:k:s>=_&&s<_+A&&n>=L&&n<L+M?E.reward:w,a[s].push({x:l,y:i,width:u,height:x,reward:e}),l+=u+m;l=1,i+=x+m}return a}(),C=d3.select('#containerInflectionPointPaths').append('svg').attr('width',`${g*t+20+2*50+z}`).attr('height',`${g*r}`),N=C.append('svg').append('svg').attr('width',`${g*t}`).attr('height',`${g*r}`),V=N.selectAll('.row').data(I).enter().append('g').attr('class','row'),U=V.selectAll('.square').data(function(t){return t}).enter().append('rect').attr('class','square').attr('x',function(t){return t.x}).attr('y',function(t){return t.y}).attr('width',function(t){return t.width}).attr('height',function(t){return t.height}).style('fill',function(t){return P(t.reward)}).style('stroke','none'),Y=N.append('rect').attr('x',E.x).attr('y',E.y).attr('width',E.width).attr('height',E.height).style('fill','none').style('stroke','red').style('stroke-width',3).style('stroke-dasharray','4, 4'),K=0,O=[2,0];const W=(t,e,a,r)=>{const l=C.append(function(){return t.documentElement.cloneNode(!0)}).attr('x',e).attr('y',a).attr('width',z).style('stroke-width',8).style('stroke',function(){return r==j?B:'none'}).attr('class','paths-arrow').on('mouseover',function(){d3.select(this).style('cursor','pointer')}).on('mouseout',function(){d3.select(this).style('cursor','default')}).on('click',function(){j=r,K++,d3.selectAll('.paths-arrow').style('stroke','none'),d3.selectAll('.paths-arrow path').style('fill',D),0==K%2?d3.select(this).style('stroke','none'):1==K%2&&(d3.select(this).style('stroke',B),d3.select(this).selectAll('path').style('fill',S)),'Right'==j?O=[1,1]:'Down'==j&&(O=[2,0]),d3.selectAll('.agent-path').remove(),c(O,T,Q),K--,setTimeout(function(){d3.selectAll('.paths-arrow').raise()},H*R)});l.selectAll('path').style('fill',function(){return r==j?S:D})};var F=d3.scaleLinear().domain([0,t]).range([0,g*t]),X=d3.scaleLinear().domain([r,0]).range([g*r,0]);const J=a;var Z=d3.line().x(function(t){return F(t[1]+0.5)}).y(function(t){return X(t[0]+0.5)}).curve(d3.curveBasis);Promise.all([d3.json('data/suboptimal_Qmu.json'),d3.json('data/suboptimal_Qsigma.json')]).then((e)=>{for(var l,i=e[0],n=e[1],o=0;o<t;o++)for(var d=0;d<r;d++)for(var p of G)l='('+d+', '+o+') '+p,T[l]=i[l],Q[l]=n[l];Promise.all([d3.xml('assets/robot.svg'),d3.xml('assets/rightArrow.svg'),d3.xml('assets/downArrow.svg')]).then((t)=>{var e=t[0],a=t[1],r=t[2];s(e,q),W(a,u+2,-130+x+d3.max([x-33,0]),'Right'),W(r,4,-130+2*x+d3.max([x-35,0]),'Down')})})}function x(t,a,l,s,r,i){function n(t,a,r=void 0){var i,n=[],o=1,d=1+L;if('qvalues'==H)var p=r[0],c=r[1],y=r[2],h=r[3];for(var m=0;m<s;m++){n.push([]);for(var u=0;u<l;u++)'update'==t&&'qvalues'==H?m==a[0]-1&&u==a[1]?i=p:m==a[0]&&u==a[1]-1?i=c:m==a[0]&&u==a[1]+1?i=y:m==a[0]+1&&u==a[1]?i=h:i=0:0==m?u==l-1?i=_:0==u?'start'==t?i=A:'update'==t&&(i=e(A,E)):i=M:m>=D&&m<D+q&&u>=S&&u<S+z?'start'==t?i=G.reward:'update'==t&&(i=e(P,B)):'start'==t?i=A:'update'==t&&(i=e(A,E)),n[m].push({x:o,y:d,width:f,height:v,reward:i}),o+=f+g;o=1,d+=v+g}return n}function o(t){var e=U.selectAll('.row').data(t).enter().append('g').attr('class','row'),a=e.selectAll('.square').data(function(t){return t}).enter().append('rect').attr('class','square').attr('x',function(t){return t.x}).attr('y',function(t){return t.y}).attr('width',function(t){return t.width}).attr('height',function(t){return t.height}).style('fill',function(t){return Q(t.reward)}).style('stroke','none').style('stroke-width',3),r=U.append('rect').attr('x',G.x).attr('y',G.y+L).attr('width',G.width).attr('height',G.height).style('fill','none').style('stroke','red').style('stroke-width',2).style('stroke-dasharray','4, 4'),i=U.append('rect').attr('x',k).attr('y',L).attr('width',8*k).attr('height',k).style('fill','none').style('stroke','red').style('stroke-width',2),s=U.append('rect').attr('x',k*(l-1)).attr('y',L).attr('width',k).attr('height',k).style('fill','none').style('stroke','green').style('stroke-width',2)}function d(t,e){var a=!0;return'Up'==e&&0>t[0]?a=!1:'Left'==e&&0>t[1]?a=!1:'Right'==e&&t[1]>l-1?a=!1:'Down'==e&&t[0]>s-1&&(a=!1),a}function p(t,a){if('explore'==R)var r=e(a[t+'Up'][j].mu,a[t+'Up'][j].sigma),l=e(a[t+'Left'][j].mu,a[t+'Left'][j].sigma),i=e(a[t+'Right'][j].mu,a[t+'Right'][j].sigma),s=e(a[t+'Down'][j].mu,a[t+'Down'][j].sigma);else if('exploit'==R)var r=a[t+'Up'][j].mu,l=a[t+'Left'][j].mu,i=a[t+'Right'][j].mu,s=a[t+'Down'][j].mu;return[r,l,i,s]}function c(t,e){const a=`(${t[0]}, ${t[1]}) `;var r,l,i=p(a,e),s=i[0],n=i[1],o=i[2],c=i[3];const y=d3.max([s,n,o,c]);return s==y?(r=[t[0]-1,t[1]],l='Up'):n==y?(r=[t[0],t[1]-1],l='Left'):o==y?(r=[t[0],t[1]+1],l='Right'):c==y&&(r=[t[0]+1,t[1]],l='Down'),d(r,l)?[r,i]:[t,i]}function y(t){for(var e,a,r=C,i=[r],n=[],o=!1;!o;)0==r[0]&&r[1]==l-1?(o=!0,e='You Win!!'):0==r[0]&&0!=r[1]?(o=!0,e='You Lose...'):i.length==l*s?(o=!0,e='You Timed Out!'):(a=c(r,t),r=a[0],i.push(r),n.push(a[1]));return[i,n,e]}function h(){lt.select('rect').attr('fill',r),lt.select('text').text('Play')}function m(){I&&d3.xml('assets/robot.svg').then((e)=>{I=!1,d3.selectAll('input[name="game-explore-exploit"]').attr('disabled',!0),rt(e,t)})}const u=parseInt(d3.select('#containerGame').style('height')),x=parseInt(d3.select('#containerGame').style('width')),g=2,f=b((x-(l-1)*g)/l),v=f,k=f+g,w=3,L=1,_=50,M=-_,A=-2,E=2,P=-15,B=15,S=1,D=1,z=2,q=3;var G={x:S*k,y:D*k,width:(f+g)*z,height:(v+g)*q,reward:P,click:0},T=['#ff6961','#eee','#66cc66'],Q=d3.scaleLinear().range(T).domain([M,0,_]),R=d3.selectAll('input[name="game-explore-exploit"]:checked').property('value'),H=d3.selectAll('input[name="game-color-scenarios"]:checked').property('value'),j=+d3.select('#sliderEpisodesGame').attr('value')-1,I=!0;document.querySelector('label[for="barEpisodesGame"] span').innerHTML=j+1;var C=[0,0],N=n('start',C,[]);const V=2*f;var U=d3.select('#containerGame').append('svg').attr('width',`${(f+g)*l}px`).attr('height',`${(v+g)*s}px`);const Y='#4C4845';var K=d3.select('#gameLegendColor').append('svg').attr('width',`${(f+g)*l}px`).attr('height',30),O=K.append('defs').append('linearGradient').attr('id','colorLegendGradient').attr('x1','0%').attr('x2','100%').attr('y1','0%').attr('y2','0%');O.selectAll('stop').data(T).enter().append('stop').style('stop-color',function(t){return t}).attr('offset',function(t,e){return 100*(e/(T.length-1))+'%'}),K.append('rect').attr('x',`${(f+g)*l/4}px`).attr('y',10).attr('width',`${(f+g)*l/2}px`).attr('height',15).style('fill','url(#colorLegendGradient)');var W='\\text{Q-Values} \\sim \\mathcal{N}(\\mu_{s,a}, \\sigma_{s,a}^2)';const F=document.querySelectorAll('#gameLegendColorLabel d-math');F[0].innerHTML=W,K.append('text').attr('x',`${(f+g)*l/4-5}px`).attr('y',18).text('-50').style('font-size','14px').style('font-weight','500').style('fill',Y).attr('alignment-baseline','middle').attr('text-anchor','end'),K.append('text').attr('x',`${3*((f+g)*l)/4+5}px`).attr('y',18).text('+50').style('font-size','14px').style('font-weight','500').style('fill',Y).attr('alignment-baseline','middle').attr('text-anchor','start');var X=d3.select('#gameLegendBottom').append('svg').attr('width',300);const J=5,Z=5,$=105,tt=205;X.append('rect').attr('x',Z).attr('y',J).attr('width',15).attr('height',15).style('fill','none').style('stroke','green').style('stroke-width',2),X.append('rect').attr('x',$).attr('y',J).attr('width',15).attr('height',15).style('fill','none').style('stroke','red').style('stroke-width',2),X.append('rect').attr('x',tt).attr('y',J).attr('width',15).attr('height',15).style('fill','none').style('stroke','red').style('stroke-width',2).style('stroke-dasharray','4, 4');const et=22,at=13;X.append('text').attr('x',Z+et).attr('y',at).text('Goal (Win)').style('font-size','12px').style('fill',Y).attr('alignment-baseline','middle'),X.append('text').attr('x',$+et).attr('y',at).text('Cliff (Lose)').style('font-size','12px').style('fill',Y).attr('alignment-baseline','middle'),X.append('text').attr('x',tt+et).attr('y',at).text('Danger Zone').style('font-size','12px').style('fill',Y).attr('alignment-baseline','middle'),o(N);const rt=(t,e)=>{const a=t.documentElement.cloneNode(!0);var d=U.append(function(){return a}).attr('y',C[0]*k+w).attr('x',C[1]*k+w).attr('width',0.9*f).attr('height',0.9*f),r=y(e),p=r[0],c=r[1],m=r[2],u=0;const i=function(){if(u++,u<p.length)U.remove(),U=d3.select('#containerGame').append('svg').attr('width',`${(f+g)*l+V+20}px`).attr('height',`${(v+g)*s}px`),N=n('update',p[u-1],c[u-1]),o(N),d=U.append(function(){return a}).attr('y',p[u-1][0]*k+w).attr('x',p[u-1][1]*k+w).attr('width',0.9*f).attr('height',0.9*f),d.transition().duration(500).attr('y',p[u][0]*k+w).attr('x',p[u][1]*k+w).on('end',i);else{h(),d.remove(),U.append('text').attr('class','game-end-text').attr('x',(f+g)*l/2).attr('y',(v+g)*s/2),U.selectAll('.game-end-text').text(m),I=!0;for(var t=document.getElementsByClassName('option-input radio'),e=0;e<t.length;e++)t[e].disabled=!1}};i()};d3.select('#sliderEpisodesGame').on('input',function(){j=+this.value-1,document.querySelector('label[for="barEpisodesGame"] span').innerHTML=j+1}),d3.selectAll('input[name="game-explore-exploit"]').on('change',function(){R=this.value,'qvalues'==H?'explore'==R?W='\\text{Q-Values} \\sim \\mathcal{N}(\\mu_{s,a}, \\sigma_{s,a}^2)':'exploit'==R&&(W='\\text{Q-Values} = \\mu_{s,a}'):'rewards'==H&&(W='\\text{Rewards}'),F[0].innerHTML=W}),d3.selectAll('input[name="game-color-scenarios"]').on('change',function(){H=this.value,'qvalues'==H?'explore'==R?W='\\text{Q-Values} \\sim \\mathcal{N}(\\mu_{s,a}, \\sigma_{s,a}^2)':'exploit'==R&&(W='\\text{Q-Values} = \\mu_{s,a}'):'rewards'==H&&(W='\\text{Rewards}'),F[0].innerHTML=W});var lt=d3.select('#playButton').append('svg');(function(){lt.append('rect').attr('fill',r).attr('width',`${V}`).attr('height',`${V/2}`).attr('rx',10).on('click',function(){U.selectAll('.game-end-text').remove(),d3.select(this).attr('fill',i),lt.select('text').text('Playing...'),m()}),lt.append('text').text('Play').attr('class','button-text').attr('x',`${V/2}`).attr('y',`${V/4}`).on('click',function(){U.selectAll('.game-end-text').remove(),lt.select('rect').attr('fill',i),lt.select('text').text('Playing...'),m()})})()}var g=Math.PI,f=Math.exp,v=Math.pow,k=Math.sqrt,w=Math.log,b=Math.floor;window.onload=function(){const e=['#156760','#1D8D84','#24B3A8','#30D5C8','#56DDD2','#7CE4DC','#A2ECE6'],a=['#f7c88e','#ed648e','#737af6','#71bdf0','#71f093','#bb6aeb','#e04c4c','#4bd1c6'];i(e[5],e[1]),n(e[6],e[2],e[0]),o(e[2],'#f29d5c',e[3]),d(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]),Promise.all([d3.json('data/qvalue_distribution_data.json'),d3.xml('assets/star.svg')]).then((t)=>{var a=t[0],r=t[1];s(a,r,e[5],e[2],e[1])});const r=['Up','Left','Right','Down'],l=10,g=6;t(l,g),p(l,g,e[6]),y(l,g),h(e[4],e[2],e[1]),m(e[4],e[2],e[1]),u(l,g,e[5],e[2],e[0]);var f={};Promise.all([d3.json('data/Qmu_historical.json'),d3.json('data/Qsigma_historical.json'),d3.json('data/Qmu_true.json'),d3.json('data/Qsigma_true.json')]).then((t)=>{for(var i,s=t[0],n=t[1],o=t[2],d=t[3],p=0;p<l;p++)for(var y=0;y<g;y++)for(var h of r){i='('+y+', '+p+') '+h,f[i]=[];for(var a=0;a<s[i].length;a++)f[i].push({x:s[i][a].x,mu:s[i][a].y,sigma:n[i][a].y,true_mu:o[i],true_sigma:d[i]})}c(f,r,l,g,e[6],e[2],'#1c7871'),x(f,r,l,g,e[3],e[6])})}});
//# sourceMappingURL=bundle.js.map
